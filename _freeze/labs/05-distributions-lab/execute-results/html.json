{
  "hash": "7c5d09d3ced6c98c145f55101ab9a2ec",
  "result": {
    "markdown": "---\ntitle: \"Lab 05: Visualizing Distributions\"\ndescription: \"A review and a deep dive into visualizing distributions in R, including bar chart, histogram, kernel density, cumulative density, and boxplot. Examples are given using base R {graphics} and {ggplot2}.\"\n---\n\n\n\n\n## Outline\n\n### Objectives\n\nThis lab will guide you through the process of  \n\n2. visualizing amounts with bar charts\n2. visualizing distributions with \n    - histograms\n    - probability density plots\n    - cumulative distribution plots\n    - boxplots\n2. base R alternatives to ggplot\n\n### R Packages\n\nWe will be using the following packages:\n\n- [archdata](https://cran.r-project.org/web/packages/archdata/index.html)\n- [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/)\n- [tidyverse](https://www.tidyverse.org)\n- [viridis](https://sjmgarnier.github.io/viridis/)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(archdata)\nlibrary(palmerpenguins)\nlibrary(tidyverse)\nlibrary(viridis)\n```\n:::\n\n\n::: {.callout-note}\nYou do not have to explicitly attach the `{graphics}` package, as it comes pre-loaded every time you open a new R session. That's partly what it means for it to be a \"base\" R package.\n:::\n\n### Data\n\n- `penguins` \n  - Includes measurements for penguin species, island in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and sex. \n  - package: `palmerpenguins`\n  - reference: <https://allisonhorst.github.io/palmerpenguins/reference/penguins.html>\n- `DartPoints`\n  - Includes measurements of 91 Archaic dart points recovered during surface surveys at Fort Hood, Texas.\n  - package: `archdata`\n  - reference: <https://cran.r-project.org/web/packages/archdata/archdata.pdf>\n- `titanic`\n    - Provides information on the fate of passengers of the Titanic, including economic status, sex, age, and survival.\n    - package: none\n    - reference: <https://wilkelab.org/SDS375/>\n    - note: we're going to download this one rather than get it from a package\n\n## Bar charts\n\nBar charts or bar plots use the length or height of bars to represent the amount of some variable across categories or groups. With `{ggplot2}`, you can create a bar chart with `geom_bar()`. As an example, we'll use the penguins data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 Ã— 8\n   species island    bill_length_mm bill_depth_mm flipper_â€¦Â¹ body_â€¦Â² sex    year\n   <fct>   <fct>              <dbl>         <dbl>      <int>   <int> <fct> <int>\n 1 Adelie  Torgersen           39.1          18.7        181    3750 male   2007\n 2 Adelie  Torgersen           39.5          17.4        186    3800 femaâ€¦  2007\n 3 Adelie  Torgersen           40.3          18          195    3250 femaâ€¦  2007\n 4 Adelie  Torgersen           NA            NA           NA      NA <NA>   2007\n 5 Adelie  Torgersen           36.7          19.3        193    3450 femaâ€¦  2007\n 6 Adelie  Torgersen           39.3          20.6        190    3650 male   2007\n 7 Adelie  Torgersen           38.9          17.8        181    3625 femaâ€¦  2007\n 8 Adelie  Torgersen           39.2          19.6        195    4675 male   2007\n 9 Adelie  Torgersen           34.1          18.1        193    3475 <NA>   2007\n10 Adelie  Torgersen           42            20.2        190    4250 <NA>   2007\n# â€¦ with 334 more rows, and abbreviated variable names Â¹â€‹flipper_length_mm,\n#   Â²â€‹body_mass_g\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(\n    aes(x = species)\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-4-1.png){width=480}\n:::\n:::\n\n\nYou can reorder the species variable based on their frequencies (with the most frequent first, the least frequent last) using `fct_infreq()`, short for _factor infrequent_. The word 'factor' here refers to the way that R represents categorical or grouping variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(\n    aes(x = fct_infreq(species))\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-5-1.png){width=480}\n:::\n:::\n\n\nIt will sometimes be preferable to orient bar charts horizontally. The simplest way to do that is to pass the factor or grouping variable to the \"y\" argument in the `aes()`. Notice that you have to change the labels, too, since the count will now be on the x-axis, species on the y-axis. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(\n    aes(y = fct_infreq(species)),\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-6-1.png){width=480}\n:::\n:::\n\n\nYou will notice now that the Adelie penguins, the most frequent species in our data, appear at the bottom. This is because the ordering starts at the origin, as it did when these were arrayed on the x-axis. In this case and in many other cases, it will make sense to re-order these with the most frequent category or species at the top and the least frequent on the bottom. To do that, we use `fct_rev()`, short for _factor reverse_, as in \"reverse the order of this factor.\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(\n    aes(y = fct_rev(fct_infreq(species)))\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-7-1.png){width=480}\n:::\n:::\n\n\nNow, let's update the default fill color and theme. We'll also remove most of the grid lines, as they do not contribute to interpreting the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(\n    aes(y = fct_rev(fct_infreq(species))),\n    fill = \"#6B8F7E\"\n  ) +\n  labs(\n    x = \"Count\", \n    y = NULL, \n    title = \"Palmer Penguins\"\n  ) +\n  theme_bw() +\n  theme(\n    panel.grid.minor = element_blank(), # remove all minor grid lines\n    panel.grid.major.y = element_blank() # remove major grid lines only on the y-axis\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-8-1.png){width=480}\n:::\n:::\n\n\n### Exercises\n\n1. Create a bar chart of the counts of dart point types using the `DartPoints` dataset (the types are stored in the `Name` variable). Remember to load that data into R with `data(\"DartPoints\")`. Then do all of the following:\n    - Re-orient the figure horizontally.\n    - Order the types by their frequency, with the most frequent on the top, the least frequent on the bottom. \n    - Add appropriate labels.\n    - Change the theme and remove unnecessary grid lines. \n    \n## Histograms \n\nA histogram is an excellent aid for visualizing the distribution of numerical data. Making one involves \"binning\" a continuous variable, counting the number of its values that fall into each bin, then drawing a rectangle for each bin whose height is proportional to the count for that bin. A good example of this is the distribution of a population over age ranges, like the age distribution of the passengers on the ill-fated voyage of the Titanic. Before we get to what the histogram looks like for this macabre example, let's first have a look at the raw data:^[These data come from Claus Wilke's [Fundamentals of Data Visualization](https://clauswilke.com/dataviz/).]\n\n::: {.callout-warning collapse=true}\n\nTo be able to work through the examples in this section, you need to run the code below. We'll explain what this code does in another lab.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntitanic <- read.csv(\"https://raw.githubusercontent.com/wilkelab/SDS375/master/datasets/titanic.csv\")\n```\n:::\n\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(titanic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  class   age    sex survived\n1   1st 29.00 female survived\n2   1st  2.00 female     died\n3   1st 30.00   male     died\n4   1st 25.00 female     died\n5   1st  0.92   male survived\n6   1st 47.00   male survived\n```\n:::\n:::\n\n\nYou see that our data has an age for each individual passenger. If we bin those ages into 5 year intervals (0-5, 5-10, 10-15, and so on) and count the number of passengers that fall into each bin or age range, we get a summary table that looks like this.\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"npgpfmhggm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n  \n  <table class=\"gt_table\" style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3;\" bgcolor=\"#FFFFFF\">\n  \n  <thead class=\"gt_col_headings\" style=\"border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3;\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Age Range\" style=\"color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; text-align: left;\" bgcolor=\"#FFFFFF\" valign=\"bottom\" align=\"left\">Age Range</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Count\" style=\"color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" bgcolor=\"#FFFFFF\" valign=\"bottom\" align=\"right\">Count</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\" \" style=\"color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" bgcolor=\"#FFFFFF\" valign=\"bottom\" align=\"right\"> </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Age Range\" style=\"color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; text-align: left;\" bgcolor=\"#FFFFFF\" valign=\"bottom\" align=\"left\">Age Range</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Count\" style=\"color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" bgcolor=\"#FFFFFF\" valign=\"bottom\" align=\"right\">Count</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\" style=\"border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3;\">\n    <tr><td headers=\"ages\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">0â€“5</td>\n<td headers=\"count\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">36</td>\n<td headers=\"separator\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">   </td>\n<td headers=\"ages2\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">41â€“45</td>\n<td headers=\"count2\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">54</td></tr>\n    <tr><td headers=\"ages\" class=\"gt_row gt_left gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: left;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"left\">6â€“10</td>\n<td headers=\"count\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">19</td>\n<td headers=\"separator\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">   </td>\n<td headers=\"ages2\" class=\"gt_row gt_left gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: left;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"left\">46â€“50</td>\n<td headers=\"count2\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">50</td></tr>\n    <tr><td headers=\"ages\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">11â€“15</td>\n<td headers=\"count\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">18</td>\n<td headers=\"separator\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">   </td>\n<td headers=\"ages2\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">51â€“55</td>\n<td headers=\"count2\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">26</td></tr>\n    <tr><td headers=\"ages\" class=\"gt_row gt_left gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: left;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"left\">16â€“20</td>\n<td headers=\"count\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">99</td>\n<td headers=\"separator\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">   </td>\n<td headers=\"ages2\" class=\"gt_row gt_left gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: left;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"left\">56â€“60</td>\n<td headers=\"count2\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">22</td></tr>\n    <tr><td headers=\"ages\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">21â€“25</td>\n<td headers=\"count\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">139</td>\n<td headers=\"separator\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">   </td>\n<td headers=\"ages2\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">61â€“65</td>\n<td headers=\"count2\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">16</td></tr>\n    <tr><td headers=\"ages\" class=\"gt_row gt_left gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: left;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"left\">26â€“30</td>\n<td headers=\"count\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">121</td>\n<td headers=\"separator\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">   </td>\n<td headers=\"ages2\" class=\"gt_row gt_left gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: left;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"left\">66â€“70</td>\n<td headers=\"count2\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">3</td></tr>\n    <tr><td headers=\"ages\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">31â€“35</td>\n<td headers=\"count\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">76</td>\n<td headers=\"separator\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">   </td>\n<td headers=\"ages2\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">71â€“75</td>\n<td headers=\"count2\" class=\"gt_row gt_right\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" align=\"right\">3</td></tr>\n    <tr><td headers=\"ages\" class=\"gt_row gt_left gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: left;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"left\">36â€“40</td>\n<td headers=\"count\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">74</td>\n<td headers=\"separator\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">   </td>\n<td headers=\"ages2\" class=\"gt_row gt_left gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: left;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"left\">76â€“80</td>\n<td headers=\"count2\" class=\"gt_row gt_right gt_striped\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: rgba(128, 128, 128, 0.05); text-align: right; font-variant-numeric: tabular-nums;\" valign=\"middle\" bgcolor=\"rgba(128, 128, 128, 0.05)\" align=\"right\">0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nHere's how those values look as bins:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-12-1.png){width=480}\n:::\n:::\n\n\nTo construct the actual histogram, we use `ggplot()` and `geom_histogram()`. Importantly, we pass `ggplot()` the raw tidy data, not the summary table, and in this case, we are going to use the default number of bins. Here is how that looks:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) + \n  geom_histogram(\n    aes(age)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-13-1.png){width=480}\n:::\n:::\n\n\nNotice that `ggplot2` provides an informative message that the default number of bins used in this plot is 30, which makes the age interval for each bin about 2.5 years. We can (and SHOULD!) change this by specifying a different number of bins with `bins`, as the number of bins can dramatically change the interpretation of the distribution. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) +\n  geom_histogram(\n    aes(age),\n    bins = 10\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-14-1.png){width=480}\n:::\n:::\n\n\nUnfortunately, the default histogram produced by ggplot2 doesn't do a great job of conveying the relationship between the axis text and the ranges represented by the widths of the rectangles. For instance, zero falls at the center of the first histogram, which would seem to suggest that the range of values represented by that rectangle includes negative ages. What it is really saying is that zero falls in the range of that bin, but that is not obvious. One solution to this issue is to set the `binwidth` (or bin width, as in the range of values for that bin) and the bin `boundary` (or where the left side of the rectangle is positioned relative to the bin range). That's a tad confusing, I know, but the basic idea is that if you set the width to 5 and the boundary to 0, then the bin for the range 0-5 will start at 0, and the bin for the range 5-10 will start at 5, and the bin for 10-15 will start at 10, and so on. Finding the best options for visualizing your data will, of course, involve some trial and error. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) +\n  geom_histogram(\n    aes(age),\n    binwidth = 5,\n    boundary = 0\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-15-1.png){width=480}\n:::\n:::\n\n\nAs always, you can change the `fill` and outline `color` for these plots by supplying those parameters to the geometry. We can also clean up the labels with `labs()` and change the theme if we like (and we do). And since the heights of these bars are what we care about, we can turn off the light vertical grid lines that `ggplot2` adds by default by specifying this as a `theme()` option. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) +\n  geom_histogram(\n    aes(age),\n    binwidth = 5,\n    boundary = 0,\n    fill = \"#6B8F7E\",\n    color = \"#4C6257\",\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Count\",\n    title = \"Passengers of the Titanic\"\n  ) +\n  theme_minimal() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-16-1.png){width=480}\n:::\n:::\n\n\nOne last point before moving on. You may have noticed that the data contains a binary variable `survived`. Do you think maybe the age distribution of those that survived differs from the distribution for those that did not survive? Do you think maybe they were older? Younger? Or is there no difference? Let's explore this a little by visualizing the different distributions using `facet_wrap()`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) +\n  geom_histogram(\n    aes(age),\n    binwidth = 5,\n    boundary = 0,\n    fill = \"#6B8F7E\",\n    color = \"#4C6257\",\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Count\",\n    title = \"Passengers of the Titanic\"\n  ) +\n  facet_wrap(vars(survived)) + # <----- adding facets here\n  theme_minimal() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor.x = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-17-1.png){width=480}\n:::\n:::\n\n\nHmmmm ðŸ¤”. What do you think this means? And how might it help to compare this to the total distribution?\n\n### Exercises\n\n1. Create a histogram of penguin bill length using the `penguins` dataset from the `{palmerpenguins}` package. Then do all of the following:\n    - Change the number of bins (try two different options).\n    - Try specifying the bin width and boundary.\n    - Change the fill and outline color.\n    - Reset the labels to be more informative.\n    - Change the theme and remove the vertical grid lines.\n2. Repeat (1), but use the `DartPoints` dataset from the `{archdata}` package, creating a histogram of dart length (`Length` in the table).  \n    - Does it look like the dart types might differ in length? Or maybe they're all basically the same?\n\n## Density Plots\n\nHere you will learn how to generate a \"density\" plot or a plot of the underlying probability density of a variable using `ggplot()` and `geom_density()`. This is similar to a histogram in that it seeks to show the distribution of a continuous random variable. It differs, however, in the way it goes about doing that. To see how they differ, let's first have a look at these two plots of the titanic data. The one on the left is a histogram, the one on the right a density plot. \n\n::: {.callout-warning collapse=true}\n\nTo be able to work through the examples in this section, you need to run the code below. We'll explain what this code does in another lab.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntitanic <- read.csv(\"https://raw.githubusercontent.com/wilkelab/SDS375/master/datasets/titanic.csv\")\n```\n:::\n\n\n:::\n\n\n::: {.cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-19-1.png){width=480}\n:::\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-19-2.png){width=480}\n:::\n:::\n\n\nThe big difference here is that histograms discretize a sample using bins, counts the number of observations that fall into each bin, and then represents those counts using the heights of the rectangles. A density plot uses a method known as kernel density estimate (or KDE) to estimate the density of each observation and represents it using the height of a smooth and continuous curve. The KDE approach works like this. First, you define the __kernel__, often the Gaussian distribution with constant variance but a mean defined by each observation. Then you define a __bandwidth__, which is used to scale each kernel. The heights of the kernels are then summed to produce a curve like the one above. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-20-1.png){width=480}\n:::\n:::\n\n\nAs with the histogram, we specify a density geometry for ggplot using `geom_density()`. We can also update the fill and outline colors, remove unnecessary grid lines, specify the labels, and choose a simpler theme.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) + \n  geom_density(\n    aes(age),\n    fill = \"#6B8F7E\",\n    color = \"#4C6257\"\n  ) +\n  theme_minimal() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-21-1.png){width=480}\n:::\n\n```{.r .cell-code}\n  labs(\n    x = \"Age (years)\",\n    y = \"Density\",\n    title = \"Passengers of the Titanic\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$x\n[1] \"Age (years)\"\n\n$y\n[1] \"Density\"\n\n$title\n[1] \"Passengers of the Titanic\"\n\nattr(,\"class\")\n[1] \"labels\"\n```\n:::\n:::\n\n\nWe can also map these aesthetics to other variables like the sex of the passenger. And, we can change the default fill colors using `scale_fill_manual()`, too.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) + \n  geom_density(\n    aes(age, fill = sex)\n  ) + \n  scale_fill_manual(\n    values = c(\"#A8BFF0\", \"#FFE66D\")\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Density\",\n    title = \"Passengers of the Titanic\"\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-22-1.png){width=480}\n:::\n:::\n\n\nIn this case, however, it's hard to see where the two distributions overlap, which makes it hard to compare them. One way to fix this is to change the opacity of the fill color using the `alpha()` function (note that the alpha or transparency of a color can range from 0 to 1.). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) + \n  geom_density(\n    aes(age, fill = sex)\n  ) + \n  scale_fill_manual(\n    values = alpha(c(\"#A8BFF0\", \"#FFE66D\"), 0.5)\n  ) +\n  labs(\n    x = \"Age\",\n    y = \"Density\",\n    title = \"Passengers of the Titanic\"\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-23-1.png){width=480}\n:::\n:::\n\n\nThis is still a little hard to read, so let's try faceting instead. Let's also drop the background vertical grid lines using the `theme()` function. At the same time, we'll go ahead and drop the label \"sex\" from the legend as that should be obvious from the key. We do that by setting `name = NULL` in `scale_fill_manual()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic, aes(age, fill = sex)) + \n  geom_density() + \n  scale_fill_manual(\n    name = NULL,\n    values = c(\"#A8BFF0\", \"#FFE66D\")\n  ) +\n  labs(\n    x = \"Age\",\n    y = \"Density\",\n    title = \"Age Distribution\",\n    subtitle = \"Passengers of the Titanic\"\n  ) +\n  facet_wrap(~sex) +\n  theme_minimal() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor.x = element_blank(),\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-24-1.png){width=480}\n:::\n:::\n\n\nNotice that the facet labels are redundant with the legend key here, so let's remove those, too. We do that by setting the theme arguments `strip.background` and `strip.text` to `element_blank()`. Finally, we can move the legend to the bottom of the plot and make it horizontal with `legend.position` and `legend.direction` respectively.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic, aes(age, fill = sex)) + \n  geom_density() + \n  scale_fill_manual(\n    name = NULL,\n    values = c(\"#A8BFF0\", \"#FFE66D\")\n  ) +\n  labs(\n    x = \"Age\",\n    y = \"Density\",\n    title = \"Age Distribution\",\n    subtitle = \"Passengers of the Titanic\"\n  ) +\n  facet_wrap(~sex) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\",\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor.x = element_blank(),\n    strip.background = element_blank(),\n    strip.text = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-25-1.png){width=480}\n:::\n:::\n\n\n### Exercises\n\n1. Make a kernel density plot of penguin bill length using `ggplot()` and `geom_density()`. Then make all of the following changes:\n    - Map penguin `species` to the `fill` aesthetic.\n    - Update the axis labels and plot title using `labs()`.\n    - Use `scale_fill_viridis` to use colorblind safe colors for the fill. Note! Species is a discrete or categorical variable, so make sure to set `discrete = TRUE`!\n    - Use `facet_wrap()` to facet by `species`.\n    - Choose a suitable theme, like `theme_minimal()`.\n    - Remove vertical grid lines.\n    - Change the legend position to bottom and make it horizontal.\n    - Remove strip text and background.  \n2. Do the same as (1), but for dart point length, and substitute dart point type for species.\n\n## Cumulative Distribution Plots\n\nWhen constructed from a sample, the cumulative distribution is technically referred to as the _empirical cumulative distribution function_ (or eCDF). It has one critical advantage over histograms and probability density plots, namely, that you don't have to specify a binwidth or bandwidth. That's because you first order the data from smallest to largest value, then count the number of observations that are equal to or less than each unique value, and increment the cumulative proportion of observations by that amount. \n\nAs a simple example, consider this vector or sample: `(0.3, 2.0, 3.4, 1.2, 2.2, 1.9)`.\n\nRearranging it smallest to largest value, we get: `(0.3, 1.2, 1.9, 2.0, 2.2, 3.4)`.\n\nNow, for each unique value, we count the number of observations that are less than or equal to it, so \n\n```md\n0.0 -> none of them, so 0\n0.3 -> just 0.3, so 1\n1.2 -> 0.3 and 1.2, so 2\n1.9 -> 0.3, 1.2, and 1.9, so 3\n2.0 -> 0.3, 1.2, 1.9, and 2.0, so 4\n2.2 -> 0.3, 1.2, 1.9, 2.0, and 2.2, so 5\n3.4 -> all of them, so 6\n```\n\nAs proportions of the total sample, which has six observations, that's \n\n```md\n0.0 -> 0/6 = 0.00\n0.3 -> 1/6 = 0.17\n1.2 -> 2/6 = 0.33 \n1.9 -> 3/6 = 0.50 \n2.0 -> 4/6 = 0.67 \n2.2 -> 5/6 = 0.83\n3.4 -> 6/6 = 1.00\n```\n\nNow, we can plot that.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-26-1.png){width=480}\n:::\n:::\n\n\nSo, fewer assumptions here, but it's also a smidge harder to interpret since it gives you the probability of being less than or equal to x, for example, the probability of being less than or equal to 1.2 is 0.33.\n\nUnfortunately, plotting the eCDF of, for example, the ages of passengers on the Titanic, is not straightforward with `{ggplot2}` because you have to use what is known as a `stat_*()` function, in this case, `stat_ecdf()`, rather than the more familiar geometry functions. This is also an example of when it would be useful to have major grid lines along both axes, so we will only remove the minor ones.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) +\n  stat_ecdf(\n    aes(age),\n    geom = \"step\",\n    color = \"#4C6257\",\n    linewidth = 1.2\n  ) +\n  theme_minimal() +\n  theme(\n    panel.grid.minor = element_blank()\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Probability\",\n    title = \"Passengers of the Titanic\"\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-27-1.png){width=480}\n:::\n:::\n\n\nYou can facet these, too, if you so desire. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(titanic) +\n  stat_ecdf(\n    aes(age, color = class),\n    geom = \"step\",\n    linewidth = 1.2\n  ) +\n  scale_color_manual(\n    name = \"Class\",\n    values = c(\"#942911\", \"#37423D\", \"#0094C6\")\n  ) +\n  theme_minimal() +\n  theme(\n    panel.grid.minor = element_blank(),\n    legend.justification = c(\"right\", \"bottom\"),\n    legend.position = c(0.98, 0.05)\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Probability\",\n    title = \"Passengers of the Titanic\"\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-28-1.png){width=480}\n:::\n:::\n\n\nTwo things to note here. First, there's the interpretation. Consider the age 40. If you follow that vertical grid line up to where it intersect the line for each class, you will see that only about 50% of first class passengers were 40 years old or younger, but for second and third class, that number is closer to 80 or even 85%. The implication here is that first class passengers on the Titanic were generally older than second and third class passengers.\n\nThe second thing to note is that I moved the legend into the plot area by specifying the legend justification and the legend position. The position may consist of character strings like \"top\" or \"bottom\" or a vector of x,y coordinates (both ranging from 0 to 1, zero for left and bottom, one for top and right). The justification determines how the legend is oriented relative to the position coordinates. In this case, the bottom right corner of the legend will be at x = 0.98 and y = 0.05. This usually requires some trial and error before finding a position you like.\n\n### Exercises\n\n1. Make an eCDF plot of penguin bill length using `ggplot()` and `stat_ecdf()`. Then make all of the following changes:\n    - Map penguin `species` to the `color` aesthetic.\n    - Update the axis labels and plot title using `labs()`.\n    - Use `scale_color_viridis` to use colorblind safe colors for the fill. Note! Species is a discrete or categorical variable, so make sure to set `discrete = TRUE`!\n    - Choose a suitable theme, like `theme_minimal()`.\n    - Remove minor grid lines on each axis.\n    - Move the legend into the plot panel.\n2. Do the same as (1), but for dart point length, and substitute dart point type for species.\n\n## Boxplots\n\nIn this section we'll learn how to make boxplots, which provide a simple but effective way of representing the distribution of a variable. For one or two variables, it's often better to use a density plot, but if you're comparing the distributions of lots of variables or lots of samples of the same variable across multiple categories, a density plot can get crowded quick. That's when it's useful to turn to boxplots, so we'll focus on that here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\ny <- rnorm(250)\n\nlabels <- tibble(\n  y = c(boxplot.stats(y)$stats, max(y)),\n  x = 0.5,\n  label = c(\"1.5 x IQR\", \"first quartile\", \"median\", \"third quartile\", \"1.5 x IQR\", \"outlier\")\n)\n\nggplot(tibble(x = 0, y), aes(x, y)) + \n  stat_boxplot(geom ='errorbar', width = 0.33) +\n  geom_boxplot(\n    fill = \"#6B8F7E\", \n    width = 0.6,\n    outlier.size = 4,\n    notch = TRUE,\n    notchwidth = 0.75\n  ) +\n  geom_text(\n    data = labels,\n    aes(x, y, label = label), \n    hjust = 0,\n    size = 11/.pt\n  ) +\n  geom_point(\n    data = tibble(x = runif(length(y), -1.2, -0.5), y = y),\n    aes(x, y),\n    size = 3,\n    color = \"#4C6257\",\n    alpha = 0.85\n  ) +\n  coord_cartesian(xlim = c(-2.2, 3)) +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-29-1.png){width=480}\n:::\n:::\n\n\nAs you can see, the boxplot shows the distribution of a variable using a five-number summary, which includes all of the following:\n\n- Minimum: the lowest value excluding outliers \n- Maximum: the greatest value excluding outliers\n- Median: the middle value that separates the data in half (also called the second quartile)\n- First quartile: the middle value of the lower half of the data, meaning 75% of the data fall above it and %25 below it (also called the lower quartile)\n- Third quartile: the middle value of the upper half of the data, meaning 25% of the data fall above it and 75% below it (also called the upper quartile)\n\nBy extension, this includes the\n\n- Interquartile Range: the distance between the first and third quartile, which includes 50% of the data.\n\nNotice that the minimum and maximum values are connected to the first and third quartiles by lines commonly referred to as \"whiskers.\" These are drawn to the largest and smallest values that fall within 1.5 * IQR of the first and third quartiles, respectively. Observations that fall above or below the whiskers are considered \"outliers\". \n\nTo make a boxplot with ggplot, we need our table of data (as always), which we pass to the `ggplot()` function. We then specify the boxplot geometry with `geom_boxplot()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_boxplot(\n    aes(x = species, y = bill_length_mm),\n    fill = \"#6B8F7E\"\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-30-1.png){width=480}\n:::\n:::\n\n\nNotice that we specified that the distribution of bill length should range over the y-axis. This makes the boxplots display vertically in the graph. We can change them to horizontal by having the variables distribution range over the x-axis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_boxplot(\n    aes(x = bill_length_mm, y = species),\n    fill = \"#6B8F7E\"\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-31-1.png){width=480}\n:::\n:::\n\n\nNow, let's update the axis labels and add a title. In this case, we'll drop the y-axis label because it should be obvious from the values there that these are different species. While we're at it, let's also change the theme settings to minimal and remove the horizontal grid lines. And, we'll add perpendicular lines at the end of the whiskers with `stat_boxplot(geom = \"errorbar\")`. Note that we move the `aes()` call up to `ggplot()`, so that these arguments can be shared between the stat and the geometry.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins, aes(x = bill_length_mm, y = species)) +\n  stat_boxplot(geom ='errorbar', width = 0.33) +\n  geom_boxplot(fill = \"#6B8F7E\") +\n  labs(\n    x = \"Bill Length (mm)\",\n    y = NULL,\n    title = \"Palmer Penguins\"\n  ) +\n  theme_bw() +\n  theme(\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n  )\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-32-1.png){width=480}\n:::\n:::\n\n\n### Exercises\n\n1. Make a boxplot showing the distribution of penguin body mass by island. Do all of the following:\n    - Position the boxes horizontally.\n    - Change the fill color to a color of your choice.\n    - Update the labels and add a title.\n    - Change the theme to one of your choice.\n    - Remove the horizontal grid lines.\n    - Add perpendicular lines to the whiskers.\n2. Do the same as (1), but for dart point length, substituting dart type for island.\n\n## Base R `{graphics}`    \n\nWhile we have focused on visualizing distributions using `{ggplot2}`, it's also useful to learn how to construct them with the `{graphics}` package from base R. The latter is not something you would want to rely on to create publication-quality figures, but it does provide simple and powerful tools for visually exploring your data. This means we will not spend much time learning the ends and outs of manipulating base R graphics to try and make them look similar to those generated with `ggplot()`. Believe me when I say that would be a painful experience. You will be best served only turning to `{graphics}` for rough and ready exploratory visualizations and not for the sort of fine-tuning you would do with `{ggplot2}` to get a figure ready for publication. With that, then, here are the base R alternatives.\n\nFair warning, we're going to make sure we have plenty of margin space for these plots, so labels and whatnot don't get cutoff. We set the margins using the `par()` function (for graphical parameters) and pass a vector of length 4 to the `mar` (for margins) argument, one value for the size of each margin.\n\nFirst, we'll get the default margins.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndefault_margins <- par()$mar\n\nbig_margins <- c(6, 8, 4, 1)\n```\n:::\n\n\n\n### Bar chart\n\nThe base R equivalent of `ggplot() + geom_bar()` is the `barplot()` function. There are many differences between these two methods, but the primary one is that `barplot()` requires you to compute the counts for each category beforehand. To do that, we'll use the handy - though misleadingly named - `table()` function. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nspecies <- table(penguins$species)\n\nspecies\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n   Adelie Chinstrap    Gentoo \n      152        68       124 \n```\n:::\n\n```{.r .cell-code}\nbarplot(\n  height = sort(species, decreasing = TRUE),\n  col = \"#6B8F7E\",\n  xlab = NULL,\n  ylab = \"Count\"\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-34-1.png){width=480}\n:::\n:::\n\n\nNotice that we re-ordered the species variable using the `sort()` function with `decreasing = TRUE` rather than `fct_infreq()`. This will work only on the summarized data generated by the `table()` function, not the raw data passed to `geom_bar()`. \n\nIf you want to make this horizontal, just specify `horiz = TRUE`. You'll also want to change the sorting to increasing, to get the most frequent species on top. And use `las = 1` to rotate the axis text so that they are horizontal, too.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mar = big_margins)\n\nbarplot(\n  height = sort(species, decreasing = FALSE),\n  horiz = TRUE,\n  las = 1,\n  col = \"#6B8F7E\",\n  xlab = \"Count\",\n  ylab = NULL\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-35-1.png){width=480}\n:::\n:::\n\n\n\n\n### Histogram\n\nThe base R equivalent of `ggplot() + geom_histogram()` is the extremely compact `hist()` function. It looks like this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# reset margins\npar(mar = default_margins)\n\nhist(\n  titanic$age,\n  breaks = seq(0, 75, by = 5),\n  xlab = \"Age (years)\",\n  ylab = \"Count\",\n  main = \"Passengers of the Titanic\",\n  col = \"#6B8F7E\",\n  border = \"#4C6257\"\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-36-1.png){width=480}\n:::\n:::\n\n\nTwo important things to note here. First, you have to pass the histogram function the variable `age`, so you have to pull out of the data.frame with `titanic$age`. Second, you use `breaks` instead of `bins` or `binwidth` to define the bins.  \n\n### Probability density\n\nThe base R equivalent of `ggplot() + geom_density()` uses the `density()` and `plot()` functions. It looks like this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde <- density(titanic$age)\n\nplot(\n  kde,\n  xlab = \"Age (years)\",\n  ylab = \"Density\",\n  main = \"Passengers of the Titanic\"\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-37-1.png){width=480}\n:::\n:::\n\n\nNote that the `density()` function does not like missing values, so if there are any NA values in your data, you will need to include the argument `na.rm = TRUE` (this tells the function to ignore missing values).\n\nTo control the fill and outline color, it's necessary to add the KDE as an additional layer to the plot with the `polygon()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde <- density(titanic$age)\n\nplot(\n  kde,\n  xlab = \"Age (years)\",\n  ylab = \"Density\",\n  main = \"Passengers of the Titanic\"\n)\n\npolygon(\n  kde,\n  col = \"#6B8F7E\",\n  border = \"#4C6257\"\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-38-1.png){width=480}\n:::\n:::\n\n\nAnd that's about as far as I want to take you with that.\n\n### Cumulative distribution\n\nThe base R equivalent of `ggplot() + stat_ecdf()` uses the `ecdf()` and `plot()` functions. It looks like this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\necdf_function <- ecdf(titanic$age)\n\nplot(\n  ecdf_function,\n  col = \"#4C6257\",\n  xlab = \"Age (years)\",\n  ylab = \"Density\",\n  main = \"Passengers of the Titanic\"\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-39-1.png){width=480}\n:::\n:::\n\n\nThat's a little weird. To get this into a proper stewise line, we need to do a little work. Specifically, we need to sort the unique age values of passengers on the Titanic. Then we need to feed those to the `ecdf_function()` we created with `ecdf()`.  We also need to specify that we want the stepwise plot type with `type = \"s\"`. Ugh... ðŸ˜•\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- sort(unique(titanic$age))\n\nplot(\n  x,\n  ecdf_function(x),\n  type = \"s\",\n  col = \"#4C6257\",\n  xlab = \"Age (years)\",\n  ylab = \"Density\",\n  main = \"Passengers of the Titanic\"\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-40-1.png){width=480}\n:::\n:::\n\n\nMother of dragons... ðŸ‰\n\n### Boxplot\n\nThe base R equivalent of `ggplot() + geom_boxplot()` is, thankfully, `boxplot()`. It looks like this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(\n  penguins$bill_length_mm ~ penguins$species,\n  col = \"#4C6257\",\n  xlab = NULL,\n  ylab = \"Bill Length (mm)\",\n  main = \"Palmer Penguins\"\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-41-1.png){width=480}\n:::\n:::\n\n\nNotice that I used the formula notation. This is to specify the grouping structure for the boxes, so a separate box for each penguin species.\n\nTo make that figure horizontal, use `horizontal = TRUE`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mar = big_margins)\n\nboxplot(\n  penguins$bill_length_mm ~ penguins$species,\n  horizontal = TRUE,\n  las = 1,\n  col = \"#4C6257\",\n  xlab = \"Bill Length (mm)\",\n  ylab = NULL,\n  main = \"Palmer Penguins\"\n)\n```\n\n::: {.cell-output-display}\n![](05-distributions-lab_files/figure-html/unnamed-chunk-42-1.png){width=480}\n:::\n:::\n\n\nHey, in the base R bar chart above, didn't we specify a horizontal orientation with `horiz = TRUE`?    \n\nYeah, yeah you did... ðŸ¤·\n\n### Exercises\n\nFor each of the following, make sure to change the fill (`col`) and outline (`border`) colors and update the labels.\n\n1. Create a bar chart of the count of dart point types using `table()` and the `barplot()` function. Give the plot a horizontal orientation.\n2. Create a histogram of penguin bill length using the `hist()` function.\n2. Create a histogram of dart point length using the `hist()` function.\n2. Create a probability density plot of penguin bill length using the `density()` and `plot()` functions. (Note that the `density()` function does not like missing values, so if there are any NA values in your data, you will need to include the argument `na.rm = TRUE` (this tells the function to ignore missing values).)\n2. Create a probability density plot of dart point length using the `density()` and `plot()` functions.\n2. Create an eCDF plot of penguin bill length using the `ecdf()` and `plot()` functions. Make sure the plot is stepwise.\n2. Create an eCDF plot of dart point length using the `ecdf()` and `plot()` functions. Make sure the plot is stepwise.\n2. Create a boxplot of penguin bill length grouped by species using the `boxplot()` function. Give the plot a horizontal orientation.\n2. Create a boxplot of dart point length grouped by dart point type using the `boxplot()` function. Give the plot a horizontal orientation.\n",
    "supporting": [
      "05-distributions-lab_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}