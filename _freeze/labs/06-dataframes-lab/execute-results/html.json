{
  "hash": "d5c46b041e83ed24675fd1edc6b3b618",
  "result": {
    "markdown": "---\ntitle: \"Lab 06: Working with Tables\"\ndescription: \"A review and a deep dive into working with rectangular data in R.\"\n---\n\n\n\n\n## Outline\n\n### Objectives\n\nThis lab will guide you through the process of  \n\n- constructing data.frames and tibbles\n- working with the pipe\n- working with columns (variables) in a table\n- working with rows (observations) in a table\n- working with grouped data in a table\n\n### R Packages\n\n- [archdata](https://cran.r-project.org/web/packages/archdata/index.html)\n- [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/)\n- [dplyr](https://dplyr.tidyverse.org/)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(archdata)\nlibrary(palmerpenguins)\nlibrary(dplyr)\n```\n:::\n\n\n### Data\n\n- `penguins` \n  - Includes measurements for penguin species, island in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and sex. \n  - package: `palmerpenguins`\n  - reference: <https://allisonhorst.github.io/palmerpenguins/reference/penguins.html>\n- `DartPoints`\n  - Includes measurements of 91 Archaic dart points recovered during surface surveys at Fort Hood, Texas.\n  - package: `archdata`\n  - reference: <https://cran.r-project.org/web/packages/archdata/archdata.pdf>\n\n## Tables\n\n::: {#fig-table style=\"text-align:center;\"}\n![](images/r-tables.png){width=\"75%\" fig-align=\"center\"}\n\nElements of a Data Frame.\n:::\n\nConsider this research scenario: you have a museum collection of projectile points that you want to use for an analysis, maybe you want to know whether East Gate and Rose Spring points are actually the same type of point, commonly referred to using the portmanteau _Rosegate_. Following tradition, you think maybe it's the size and shape that will you help finally put this old question to rest, so for each individual point, you set about measuring its length, width, and height. \n\nIn this course, we'll refer to each individual measure that you make as a _value_, each set of such measures for an individual point we will call (somewhat awkwardly) an _observation_, and each individual type of measurement will be a _variable_. It is almost certainly the case that you will be collecting this data and storing it in something like a spreadsheet or table, like that shown in @fig-table. You will sometimes hear data scientists refer to data stored in this way as _rectangular_ data. All they mean by that is that the data come as collections of values organized into rows and columns. Crucially, all the columns must have the same length, so you can describe the data as having dimensions, specifically length (the number of observations or rows) and width (the number of variables or columns). \n\n### Creating tables\n\nIn R, tabular datasets are known as _data frames_. To create a data frame, we use the eponymous `data.frame()` function. Here, for example, is how we would create the table in @fig-table above:  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nprojectiles_df <- data.frame(\n  type = c(\"Elko\", \"Rosegate\", \"DSN\", \"Elko\", \"Clovis\"),\n  length = c(2.03, 1.4, 1.9, 2.1, 3.3),\n  width = c(0.8, 0.4, 0.3, 0.7, 0.95),\n  height = c(3.23, 2.4, 1.29, 2.7, 4.15)\n)\n\nprojectiles_df\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      type length width height\n1     Elko   2.03  0.80   3.23\n2 Rosegate   1.40  0.40   2.40\n3      DSN   1.90  0.30   1.29\n4     Elko   2.10  0.70   2.70\n5   Clovis   3.30  0.95   4.15\n```\n:::\n:::\n\n\nNote that the values (or measurements) contained in each variable are wrapped in the `c()` function (short for _concatenate_). This variable tells R that all these values belong to this one variable. Each variable in turn is an argument to `data.frame()` having the form `<variable> = c(<value-1>, <value-2>, ..., <value-n>)`.\n\n### Getting basic meta-data from tables \n\nWhen you want to know what variables a table includes, you can use the `names()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(projectiles_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"type\"   \"length\" \"width\"  \"height\"\n```\n:::\n:::\n\n\nIf you want to know how many variables or observations the table has, you can use `nrow()` and `ncol()` respectively.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# number of observations\nnrow(projectiles_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5\n```\n:::\n\n```{.r .cell-code}\n# number of variables\nncol(projectiles_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4\n```\n:::\n:::\n\n\n### Pretty tibbles\n\nAs an alternative to the default `data.frame`, you can also use a `tibble`, which is a standard format used by packages within the `tidyverse`, including the `tibble` package that defines it. In the grand scheme of things, the differences between tibbles and data.frames are quite small, mostly relating to their nicer (some might say prettier) print methods. It has some other nice features, but most of them are not things that should concern a beginning R user, so we won't dwell on them here.\n\nYou create a tibble just like you would a data.frame, but with the `tibble()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprojectiles_tbl <- tibble(\n  type = c(\"Elko\", \"Rosegate\", \"DSN\", \"Elko\", \"Clovis\"),\n  length = c(2.03, 1.4, 1.9, 2.1, 3.3),\n  width = c(0.8, 0.4, 0.3, 0.7, 0.95),\n  height = c(3.23, 2.4, 1.29, 2.7, 4.15)\n)\n```\n:::\n\n\nNow you can see how the print method for tibbles differs from that of data.frames.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprojectiles_df\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      type length width height\n1     Elko   2.03  0.80   3.23\n2 Rosegate   1.40  0.40   2.40\n3      DSN   1.90  0.30   1.29\n4     Elko   2.10  0.70   2.70\n5   Clovis   3.30  0.95   4.15\n```\n:::\n\n```{.r .cell-code}\nprojectiles_tbl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 4\n  type     length width height\n  <chr>     <dbl> <dbl>  <dbl>\n1 Elko       2.03  0.8    3.23\n2 Rosegate   1.4   0.4    2.4 \n3 DSN        1.9   0.3    1.29\n4 Elko       2.1   0.7    2.7 \n5 Clovis     3.3   0.95   4.15\n```\n:::\n:::\n\n\nThere are a few big differences here:\n\n1. By default `tibble()` will only print the first ten rows of data. This saves you from having to use the `head()` function. It will also tell you how many rows were not printed at the bottom, assuming there are more than ten. With `data.frame()`, the default print will print the maximum number of rows defined in your default options.\n2. `tibble()` will only print columns that fit on your screen. It will then tell you how many columns were not printed.\n2. `tibble()` provides information about the dimensions of your table: the number of rows and columns.\n3. `tibble()` provides information about the type of data each variable is: factor (`fct`), character, numeric (`dbl` for \"double\" or `int` for \"integer\").\n\nWhile the choice between `tibbles` and `data.frames` is largely a stylistic one, I would encourage you to use `tibbles` as much as possible. It'll make things easier for you in the long run. You can always convert between them if you want with `as_tibble()` and `as.data.frame()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# turn a tibble into a data.frame\nprojectiles_df <- as.data.frame(projectiles_tbl)\n\n# turn a data.frame into a tibble\nprojectiles_tbl <- as_tibble(projectiles_df)\n```\n:::\n\n\nIn what follows, we are going to learn how to perform some tasks that almost always arise when working with tables using a powerful set of tools provided by the `dplyr` package, which is part of the `tidyverse`.\n\n### Exercises\n\n1. Get the names of the variables in the `penguins` table with `names()`.\n2. How many observations and variables are in this dataset? Hint: use `nrow()` and `ncol()`.\n2. Load the DartPoints dataset and convert the data.frame to a tibble with `as_tibble()`. Assign it to a new object called \"darts\" using the arrow `<-`. Then remove the original DartPoints dataframe from your environment with `remove(DartPoints)`.\n\n## The Pipe\n\n::: {#fig-pipe}\n![](https://upload.wikimedia.org/wikipedia/en/b/b9/MagrittePipe.jpg)\n\n[[The Treachery of Images](https://en.wikipedia.org/wiki/The_Treachery_of_Images) (1929) by Rene Magritte.]{style=\"margin: 0 auto;\"}\n:::\n\nBefore we get to the ways in which you can shape and otherwise manipulate tables in R, though, let's introduce a style of coding referred to as `piping` first, which allows you to express a series of operations in a clear and concise way. To motivate the use of pipes, consider this extremely common scenario: you want to select some specific variables in your table, filter the observations to include a subset based on some condition, then add a new variable by transforming or mutating another one. Your code might look like this (we will explain how to use these functions in just a moment):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbob <- select(penguins, species, island, bill_length_mm, body_mass_g)\ntom <- filter(bob, sex == \"male\")\nsue <- mutate(tom, bill_length_cm = bill_length_mm/10)\n\nremove(bob, tom)\n```\n:::\n\n\nYou will sometimes see people write the same series of function calls this way:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsue <- mutate(filter(select(penguins, species, island, bill_length_mm, body_mass_g), island == \"Torgersen\"), bill_length_cm = bill_length_mm/10)\n```\n:::\n\n\nThis is called _nesting_. It's primary advantage is that it does not require saving intermediate objects (like `bob` and `tom`) and thus polluting your R environment with unnecessary copies of your data. Nesting function calls in this way is fine as long as it remains relatively _shallow_, but the deeper the nest (like 2 or 3 functions deep), the harder it is to read, as you must follow results from the inside out and bottom up, as opposed to left to right and top down, which is more natural. \n\nTo avoid deep nests _and_ temporary assignments, you can use pipes. This involves calling the special operator, `|>`, consisting of a vertical bar and the greater-than sign that was introduced to base R in 2021 with version 4.1.0. If you squint (and depending on the font you are using), it looks a bit like an arrow pointing to the right. Using the pipe-operator looks like this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsue <- penguins |> \n  select(species, sex, body_mass_g) |> \n  filter(sex == \"male\") |> \n  mutate(bill_length_cm = bill_length_mm/10)\n```\n:::\n\n\nIf you were to transpose this code into a natural language like English, it would sound something like this,\n\n> Take the penguins table, then select the variables species, sex, and body mass, then filter the males, then create a new variable by converting bill length from millimeters to centimeters.\n\nThe 'then' in each case is the pipe operator. Crucially, the pipe assumes that the data being transformed is the first argument to the function, which is true for all the functions in the `tidyverse`, as they were all designed very intentionally to work with the pipe. Unfortunately, many parts of R were written long before the pipe was ever introduced, so they may not work as easily with it. \n\n::: {.callout-tip}\n## Tip: keyboard shortcut\n\nThis is easily one of the most powerful tools for working with data in R, which is probably why it is so popular these days. RStudio gives a keyboard shortcut to make inserting this operator into your code easier. It's `Ctrl + Shift + M` on Windows and `Cmd + Shift + M` on Mac. To ensure that this keyboard shortcut inserts the base R pipe operator, go to Tools > Global Options... > Code > Editing and check that the option \"Use native pipe operator, |> (requires R 4.1+)\" is selected.\n\n:::\n\n## Columns\n\nNow that we have the pipe, let's look at different ways of working with variables or columns in a table. Some of the most common tasks involve selecting a subset of variables, relocating them, renaming them, and creating new variables. As mentioned before, the focus here will be on `dplyr` functions, but we will also take some time to introduce base R methods where appropriate.\n\n### `pull()`\n\nTo pull a variable out of a table and return it as a vector, you can pass the table along with the name of the target variable to the `pull()` function from `dplyr`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprojectiles_tbl |> pull(type)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Elko\"     \"Rosegate\" \"DSN\"      \"Elko\"     \"Clovis\"  \n```\n:::\n\n```{.r .cell-code}\nprojectiles_tbl |> pull(length)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.03 1.40 1.90 2.10 3.30\n```\n:::\n:::\n\n\nThe base R way of doing this relies on double brackets or the dollar sign, as in `<table>[[\"<variable>\"]]` and `<table>$<variable>`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprojectiles_tbl$type\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Elko\"     \"Rosegate\" \"DSN\"      \"Elko\"     \"Clovis\"  \n```\n:::\n\n```{.r .cell-code}\nprojectiles_tbl[[\"length\"]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.03 1.40 1.90 2.10 3.30\n```\n:::\n:::\n\n\nAs you can see, using the `dplyr` function is quite a bit easier to read and intuit what you are doing. It also plays nice with the pipe. \n\n### `select()`\n\nIf you want to select one or more variables but return the result as a table, pass the table along with the names of the desired variables to `select()`. As an example, suppose (for reasons) that we want a smaller table that only has the `species` and `bill_length_mm` variables. To get that from the larger table, I simply do this\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> select(species, bill_length_mm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 2\n   species bill_length_mm\n   <fct>            <dbl>\n 1 Adelie            39.1\n 2 Adelie            39.5\n 3 Adelie            40.3\n 4 Adelie            NA  \n 5 Adelie            36.7\n 6 Adelie            39.3\n 7 Adelie            38.9\n 8 Adelie            39.2\n 9 Adelie            34.1\n10 Adelie            42  \n# … with 334 more rows\n```\n:::\n:::\n\n\n### `rename()`\n\nTo rename variables in a table, use the `rename()` function. This is similar to `pull()` and `select()` in that you pass it column names, but you are also going to signal new names for those columns using the equal sign. The idea here is to do `rename(<new name> = <old name>)`. Here, for example, is how you might remove the units of measure from the variable names in the penguins table.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> names()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"species\"           \"island\"            \"bill_length_mm\"   \n[4] \"bill_depth_mm\"     \"flipper_length_mm\" \"body_mass_g\"      \n[7] \"sex\"               \"year\"             \n```\n:::\n\n```{.r .cell-code}\npenguins |> \n  rename(\n    bill_length = bill_length_mm,\n    bill_depth = bill_depth_mm,\n    flipper_length = flipper_length_mm,\n    body_mass = body_mass_g\n  ) |> \n  names()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"species\"        \"island\"         \"bill_length\"    \"bill_depth\"    \n[5] \"flipper_length\" \"body_mass\"      \"sex\"            \"year\"          \n```\n:::\n:::\n\n\n::: {.callout-note}\n## A good rule of 👍\n\nHere are a few good rules of thumb for variable names in tables (and for all names in R!).\n\n1. Use all lower-case characters. This makes them easier to type.\n2. Avoid special characters. They require special treatment when included.\n2. Use underscores `_` instead of spaces for similar reasons.\n2. Try to keep the names as simple as possible but...\n2. Air on the side of longer names that clearly communicate the meaning of each variable.\n\n:::\n\nHere is one trick you might find useful. Sometimes you will find yourself wanting to rename all the variables in a consistent way, for instance, by making them all lower case. This is something I find myself doing quite often actually. Base R has this nice function called `tolower()` that converts capitalized letters to lowercase. For instance, `tolower(\"ABC\")` returns `abc`. There's a corresponding `toupper()` that does the opposite. You can apply these functions to every column in one go with `rename_with()`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  rename_with(toupper) |> \n  names()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"SPECIES\"           \"ISLAND\"            \"BILL_LENGTH_MM\"   \n[4] \"BILL_DEPTH_MM\"     \"FLIPPER_LENGTH_MM\" \"BODY_MASS_G\"      \n[7] \"SEX\"               \"YEAR\"             \n```\n:::\n:::\n\n\n### `relocate()`\n\nYou will sometimes find it helpful to reorder your variables. To do that, you can use `relocate()`, again passing it the column names. By default, it moves variables to the front, but you can also move them before or after specific variables with the `.before` and `.after` arguments.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> names()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"species\"           \"island\"            \"bill_length_mm\"   \n[4] \"bill_depth_mm\"     \"flipper_length_mm\" \"body_mass_g\"      \n[7] \"sex\"               \"year\"             \n```\n:::\n\n```{.r .cell-code}\npenguins |> relocate(sex, year) |> names()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"sex\"               \"year\"              \"species\"          \n[4] \"island\"            \"bill_length_mm\"    \"bill_depth_mm\"    \n[7] \"flipper_length_mm\" \"body_mass_g\"      \n```\n:::\n\n```{.r .cell-code}\npenguins |> relocate(sex, year, .after = island) |> names()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"species\"           \"island\"            \"sex\"              \n[4] \"year\"              \"bill_length_mm\"    \"bill_depth_mm\"    \n[7] \"flipper_length_mm\" \"body_mass_g\"      \n```\n:::\n:::\n\n\n### `mutate()`\n\nOne of the most important and powerful functions provided by `dplyr` is `mutate()`. This allows you to add or change variables, often based on the values of other variables in your table. For instance, you can create a new variable that codes bill length in centimeters rather than millimeters. You just divide millimeters by 10.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  mutate(bill_length_cm = bill_length_mm/10) |> \n  select(species, bill_length_mm, bill_length_cm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 3\n   species bill_length_mm bill_length_cm\n   <fct>            <dbl>          <dbl>\n 1 Adelie            39.1           3.91\n 2 Adelie            39.5           3.95\n 3 Adelie            40.3           4.03\n 4 Adelie            NA            NA   \n 5 Adelie            36.7           3.67\n 6 Adelie            39.3           3.93\n 7 Adelie            38.9           3.89\n 8 Adelie            39.2           3.92\n 9 Adelie            34.1           3.41\n10 Adelie            42             4.2 \n# … with 334 more rows\n```\n:::\n:::\n\n\nYou can refer to as many variables in the table as you like, too. For instance, you can calculate the ratio of bill length to flipper length.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  mutate(bill_to_flipper = bill_length_mm/flipper_length_mm) |> \n  select(species, bill_length_mm, flipper_length_mm, bill_to_flipper)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 4\n   species bill_length_mm flipper_length_mm bill_to_flipper\n   <fct>            <dbl>             <int>           <dbl>\n 1 Adelie            39.1               181           0.216\n 2 Adelie            39.5               186           0.212\n 3 Adelie            40.3               195           0.207\n 4 Adelie            NA                  NA          NA    \n 5 Adelie            36.7               193           0.190\n 6 Adelie            39.3               190           0.207\n 7 Adelie            38.9               181           0.215\n 8 Adelie            39.2               195           0.201\n 9 Adelie            34.1               193           0.177\n10 Adelie            42                 190           0.221\n# … with 334 more rows\n```\n:::\n:::\n\n\nWhen you work with `mutate()`, keep in mind that data.frames and tibbles are _rectangular_. That means each variable in the table must have the same number of _values_ (equal to the number of rows or _observations_ in the table). In the penguins table, there are 344 observations, so any new variable that you add with `mutate()` must have 344 values (it must have that length). If the variable you want to add does not have the same length, you will receive an error like the following: \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> mutate(id = 1:5)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `mutate()`:\n! Problem while computing `id = 1:5`.\n✖ `id` must be size 344 or 1, not 5.\n```\n:::\n:::\n\n\nNote, too, that you can refer to new variables you have created in the same `mutate()` call.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  select(species, island) |> \n  mutate(\n    id = 1:n(),\n    id2 = id * 2\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 4\n   species island       id   id2\n   <fct>   <fct>     <int> <dbl>\n 1 Adelie  Torgersen     1     2\n 2 Adelie  Torgersen     2     4\n 3 Adelie  Torgersen     3     6\n 4 Adelie  Torgersen     4     8\n 5 Adelie  Torgersen     5    10\n 6 Adelie  Torgersen     6    12\n 7 Adelie  Torgersen     7    14\n 8 Adelie  Torgersen     8    16\n 9 Adelie  Torgersen     9    18\n10 Adelie  Torgersen    10    20\n# … with 334 more rows\n```\n:::\n:::\n\n\n### Exercises\n\n1. Remind yourself of what variables the penguins table has with `names()`.\n2. Now, extract a variable of your choice with `pull()`.\n2. Subset the data by choosing only four variables of your choice with `select()`.\n2. Use `relocate()` to move the species and island variables after bill_length_mm.\n2. Use `mutate()` on the `penguins` data to create variables that\n    - represent body mass in kilograms,\n    - represent bill depth in centimeters,\n    - compare bill length to bill depth to see whether the former is greater than (`>`) the latter.\n2. Using the `darts` tibble (formerly the DartPoints data.frame), rename the variables so that they are all lower case, rename the \"name\" variable to \"type\", and subset to the type, length, width, and thickness variables. Reassign this to darts, so you can save the result. Hint:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndarts <- darts |> \n  rename_with() |> \n  rename() |> \n  selet()\n```\n:::\n\n\n2. Use `mutate()` to add a variable to `darts` that is the ratio of point length to width.\n\n## Rows\n\n### `arrange()`\n\nSometimes it can be useful to sort a table, so you can more easily navigate the information it contains. To do this, `dplyr` provides the `arrange()` function. This sorts observations based on a supplied variable or variables. By default, it sorts observations in ascending order. If you provide multiple variables, it will sort the first variable first, then sort the second variable within that variable, and so on. In effect, it breaks ties in the sorting process.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> arrange(species, island)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 8\n   species island bill_length_mm bill_depth_mm flipper_len…¹ body_…² sex    year\n   <fct>   <fct>           <dbl>         <dbl>         <int>   <int> <fct> <int>\n 1 Adelie  Biscoe           37.8          18.3           174    3400 fema…  2007\n 2 Adelie  Biscoe           37.7          18.7           180    3600 male   2007\n 3 Adelie  Biscoe           35.9          19.2           189    3800 fema…  2007\n 4 Adelie  Biscoe           38.2          18.1           185    3950 male   2007\n 5 Adelie  Biscoe           38.8          17.2           180    3800 male   2007\n 6 Adelie  Biscoe           35.3          18.9           187    3800 fema…  2007\n 7 Adelie  Biscoe           40.6          18.6           183    3550 male   2007\n 8 Adelie  Biscoe           40.5          17.9           187    3200 fema…  2007\n 9 Adelie  Biscoe           37.9          18.6           172    3150 fema…  2007\n10 Adelie  Biscoe           40.5          18.9           180    3950 male   2007\n# … with 334 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#   ²​body_mass_g\n```\n:::\n:::\n\n\nYou can use the `desc()` function to sort descending.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> arrange(desc(species))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 8\n   species island bill_length_mm bill_depth_mm flipper_len…¹ body_…² sex    year\n   <fct>   <fct>           <dbl>         <dbl>         <int>   <int> <fct> <int>\n 1 Gentoo  Biscoe           46.1          13.2           211    4500 fema…  2007\n 2 Gentoo  Biscoe           50            16.3           230    5700 male   2007\n 3 Gentoo  Biscoe           48.7          14.1           210    4450 fema…  2007\n 4 Gentoo  Biscoe           50            15.2           218    5700 male   2007\n 5 Gentoo  Biscoe           47.6          14.5           215    5400 male   2007\n 6 Gentoo  Biscoe           46.5          13.5           210    4550 fema…  2007\n 7 Gentoo  Biscoe           45.4          14.6           211    4800 fema…  2007\n 8 Gentoo  Biscoe           46.7          15.3           219    5200 male   2007\n 9 Gentoo  Biscoe           43.3          13.4           209    4400 fema…  2007\n10 Gentoo  Biscoe           46.8          15.4           215    5150 male   2007\n# … with 334 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#   ²​body_mass_g\n```\n:::\n:::\n\n\n### `distinct()`\n\nObservations will sometimes be duplicated in your data. The simplest way to remove them is with the `distinct()` function. For demonstration purposes, suppose you have this simple dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl <- tibble(\n  x = c(1, 1, 1, 3, 2), \n  y = c(\"a\", \"a\", \"a\", \"b\", \"c\"),\n  z = c(TRUE, TRUE, FALSE, TRUE, TRUE)\n)\n\ntbl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 3\n      x y     z    \n  <dbl> <chr> <lgl>\n1     1 a     TRUE \n2     1 a     TRUE \n3     1 a     FALSE\n4     3 b     TRUE \n5     2 c     TRUE \n```\n:::\n:::\n\n\nFor whatever reason, your first observation or row has been duplicated (there are two rows with the values _x=1_, _y=a_, and _z=TRUE_). To remove that row, do this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl |> distinct()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 3\n      x y     z    \n  <dbl> <chr> <lgl>\n1     1 a     TRUE \n2     1 a     FALSE\n3     3 b     TRUE \n4     2 c     TRUE \n```\n:::\n:::\n\n\nYou may also want distinct combinations of a specific variable or variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl |> distinct(x, y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n      x y    \n  <dbl> <chr>\n1     1 a    \n2     3 b    \n3     2 c    \n```\n:::\n:::\n\n\n### `filter()`\n\nSubsetting data by filtering observations is a little bit more involved than simply selecting variables, but intuitively, you are simply asking for those observations that satisfy a certain condition. Getting `filter()` to return those observations requires that you pass it an expression containing a comparison operator. The expression is then evaluated by R for its truth or falsity, with observations that evaluate to `TRUE` being returned, observations that evaluate to `FALSE` being ignored. Let's walk through an example, then try to break down what is happening in a little more detail. Suppose we want only those observations of penguins residing on Biscoe Island. Here is how we would go about collecting those observations from our penguins data.frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> filter(island == \"Biscoe\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 168 × 8\n   species island bill_length_mm bill_depth_mm flipper_len…¹ body_…² sex    year\n   <fct>   <fct>           <dbl>         <dbl>         <int>   <int> <fct> <int>\n 1 Adelie  Biscoe           37.8          18.3           174    3400 fema…  2007\n 2 Adelie  Biscoe           37.7          18.7           180    3600 male   2007\n 3 Adelie  Biscoe           35.9          19.2           189    3800 fema…  2007\n 4 Adelie  Biscoe           38.2          18.1           185    3950 male   2007\n 5 Adelie  Biscoe           38.8          17.2           180    3800 male   2007\n 6 Adelie  Biscoe           35.3          18.9           187    3800 fema…  2007\n 7 Adelie  Biscoe           40.6          18.6           183    3550 male   2007\n 8 Adelie  Biscoe           40.5          17.9           187    3200 fema…  2007\n 9 Adelie  Biscoe           37.9          18.6           172    3150 fema…  2007\n10 Adelie  Biscoe           40.5          18.9           180    3950 male   2007\n# … with 158 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#   ²​body_mass_g\n```\n:::\n:::\n\n\nHere we supplied this key information to `filter()`: \n\n```\nisland == \"Biscoe\"\n``` \n\nWhat does this expression mean exactly? In effect, it is directing `filter()` to scan through our data, specifically the `island` column, and select only those rows where the value is _Biscoe_. The so-called _comparison operator_ here is the double equal sign, `==`. This is importantly different than the single equal sign, `=`, which is used inside a function as part of a `key=value` or `argument=value` pair. R provides several helpful comparison operators:  \n\n* `==` for _equals_ in the sense of a perfect match,  \n* `!=` for _not equals_,  \n* `>` for _greater than_,  \n* `>=` for _greater than or equal to_,  \n* `<` for _less than_, and  \n* `<=` for _less than or equal to_.  \n\nYou can use the first two, `==` and `!=`, for comparisons with either character or numeric variables, but the rest apply only to the latter. Let's run through a few more examples:  \n\n_Filter penguins with body mass greater than 3500 grams_.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> filter(body_mass_g > 3500)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 264 × 8\n   species island    bill_length_mm bill_depth_mm flipper_…¹ body_…² sex    year\n   <fct>   <fct>              <dbl>         <dbl>      <int>   <int> <fct> <int>\n 1 Adelie  Torgersen           39.1          18.7        181    3750 male   2007\n 2 Adelie  Torgersen           39.5          17.4        186    3800 fema…  2007\n 3 Adelie  Torgersen           39.3          20.6        190    3650 male   2007\n 4 Adelie  Torgersen           38.9          17.8        181    3625 fema…  2007\n 5 Adelie  Torgersen           39.2          19.6        195    4675 male   2007\n 6 Adelie  Torgersen           42            20.2        190    4250 <NA>   2007\n 7 Adelie  Torgersen           37.8          17.3        180    3700 <NA>   2007\n 8 Adelie  Torgersen           38.6          21.2        191    3800 male   2007\n 9 Adelie  Torgersen           34.6          21.1        198    4400 male   2007\n10 Adelie  Torgersen           36.6          17.8        185    3700 fema…  2007\n# … with 254 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#   ²​body_mass_g\n```\n:::\n:::\n\n\n_Filter penguins with beaks longer than 39 millimeters_.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> filter(bill_length_mm > 39)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 260 × 8\n   species island    bill_length_mm bill_depth_mm flipper_…¹ body_…² sex    year\n   <fct>   <fct>              <dbl>         <dbl>      <int>   <int> <fct> <int>\n 1 Adelie  Torgersen           39.1          18.7        181    3750 male   2007\n 2 Adelie  Torgersen           39.5          17.4        186    3800 fema…  2007\n 3 Adelie  Torgersen           40.3          18          195    3250 fema…  2007\n 4 Adelie  Torgersen           39.3          20.6        190    3650 male   2007\n 5 Adelie  Torgersen           39.2          19.6        195    4675 male   2007\n 6 Adelie  Torgersen           42            20.2        190    4250 <NA>   2007\n 7 Adelie  Torgersen           41.1          17.6        182    3200 fema…  2007\n 8 Adelie  Torgersen           42.5          20.7        197    4500 male   2007\n 9 Adelie  Torgersen           46            21.5        194    4200 male   2007\n10 Adelie  Biscoe              40.6          18.6        183    3550 male   2007\n# … with 250 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#   ²​body_mass_g\n```\n:::\n:::\n\n\n#### Multiple conditions\n\nOften enough, we will want to combine a number of these simple conditions into one complex expression. In R, this is done with Boolean operators:  \n\n* `&` for _and_,  \n*  `|` for _or_, and  \n* `!` for _not_.  \n\nTo demonstrate the underlying logic of these Boolean operators, consider these shapes and colors. You can think of each of A, B, and C as its own observation or row in a data.frame that includes two variables `color` and `shape`.  \n\n::: {style=\"width:80%; margin:0 auto;\"}\n\n![](images/booleans_example.png){fig-align=\"center\" width=70%}\n\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"soobryqtld\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n  \n  <table class=\"gt_table\" style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3;\" bgcolor=\"#FFFFFF\">\n  \n  <thead class=\"gt_col_headings\" style=\"border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3;\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Boolean\" style=\"color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; text-align: left;\" bgcolor=\"#FFFFFF\" valign=\"bottom\" align=\"left\">Boolean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Filter\" style=\"color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; text-align: left;\" bgcolor=\"#FFFFFF\" valign=\"bottom\" align=\"left\">Filter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Result\" style=\"color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; text-align: left;\" bgcolor=\"#FFFFFF\" valign=\"bottom\" align=\"left\">Result</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\" style=\"border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3;\">\n    <tr><td headers=\"Boolean\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">x</td>\n<td headers=\"Filter\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\"><div class=\"gt_from_md\"><p style=\"margin-top: 0; margin-bottom: 0;\"><code>color == &quot;yellow&quot;</code></p>\n</div></td>\n<td headers=\"Result\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">A, B</td></tr>\n    <tr><td headers=\"Boolean\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">y</td>\n<td headers=\"Filter\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\"><div class=\"gt_from_md\"><p style=\"margin-top: 0; margin-bottom: 0;\"><code>shape == &quot;circle&quot;</code></p>\n</div></td>\n<td headers=\"Result\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">B, C</td></tr>\n    <tr><td headers=\"Boolean\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">x &amp; y</td>\n<td headers=\"Filter\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\"><div class=\"gt_from_md\"><p style=\"margin-top: 0; margin-bottom: 0;\"><code>color == &quot;yellow&quot; &amp; shape == &quot;circle&quot;</code></p>\n</div></td>\n<td headers=\"Result\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">B</td></tr>\n    <tr><td headers=\"Boolean\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">x | y</td>\n<td headers=\"Filter\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\"><div class=\"gt_from_md\"><p style=\"margin-top: 0; margin-bottom: 0;\"><code>color == &quot;yellow&quot; | shape == &quot;circle&quot;</code></p>\n</div></td>\n<td headers=\"Result\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">A, B, C</td></tr>\n    <tr><td headers=\"Boolean\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">x &amp; !y</td>\n<td headers=\"Filter\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\"><div class=\"gt_from_md\"><p style=\"margin-top: 0; margin-bottom: 0;\"><code>color == &quot;yellow&quot; &amp; shape != &quot;circle&quot;</code></p>\n</div></td>\n<td headers=\"Result\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">A</td></tr>\n    <tr><td headers=\"Boolean\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">!x &amp; y</td>\n<td headers=\"Filter\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\"><div class=\"gt_from_md\"><p style=\"margin-top: 0; margin-bottom: 0;\"><code>color != &quot;yellow&quot; &amp; shape == &quot;circle&quot;</code></p>\n</div></td>\n<td headers=\"Result\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">C</td></tr>\n    <tr><td headers=\"Boolean\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">!(x &amp; y)</td>\n<td headers=\"Filter\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\"><div class=\"gt_from_md\"><p style=\"margin-top: 0; margin-bottom: 0;\"><code>!(color == &quot;yellow&quot; &amp; shape == &quot;circle&quot;)</code></p>\n</div></td>\n<td headers=\"Result\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">A, C</td></tr>\n    <tr><td headers=\"Boolean\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">!(x | y)</td>\n<td headers=\"Filter\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\"><div class=\"gt_from_md\"><p style=\"margin-top: 0; margin-bottom: 0;\"><code>!(color == &quot;yellow&quot; | shape == &quot;circle&quot;)</code></p>\n</div></td>\n<td headers=\"Result\" class=\"gt_row gt_left\" style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; text-align: left;\" valign=\"middle\" align=\"left\">NULL</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n\n:::\n\nAnd here is an example with our penguins data, where we ask R to return those observations in which (a) penguins reside on Biscoe Island and (b) their bills are longer than 39 millimeters.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> filter(island == \"Biscoe\" & bill_length_mm > 39)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 143 × 8\n   species island bill_length_mm bill_depth_mm flipper_len…¹ body_…² sex    year\n   <fct>   <fct>           <dbl>         <dbl>         <int>   <int> <fct> <int>\n 1 Adelie  Biscoe           40.6          18.6           183    3550 male   2007\n 2 Adelie  Biscoe           40.5          17.9           187    3200 fema…  2007\n 3 Adelie  Biscoe           40.5          18.9           180    3950 male   2007\n 4 Adelie  Biscoe           39.6          17.7           186    3500 fema…  2008\n 5 Adelie  Biscoe           40.1          18.9           188    4300 male   2008\n 6 Adelie  Biscoe           42            19.5           200    4050 male   2008\n 7 Adelie  Biscoe           41.4          18.6           191    3700 male   2008\n 8 Adelie  Biscoe           40.6          18.8           193    3800 male   2008\n 9 Adelie  Biscoe           41.3          21.1           195    4400 male   2008\n10 Adelie  Biscoe           41.1          18.2           192    4050 male   2008\n# … with 133 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#   ²​body_mass_g\n```\n:::\n:::\n\n\nNote that `filter()` let's you separate conditions with a comma, which it interprets as conjunction, represented by the `&`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  filter(\n    island == \"Biscoe\", \n    species == \"Adelie\", \n    body_mass_g < 3500\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 8\n   species island bill_length_mm bill_depth_mm flipper_len…¹ body_…² sex    year\n   <fct>   <fct>           <dbl>         <dbl>         <int>   <int> <fct> <int>\n 1 Adelie  Biscoe           37.8          18.3           174    3400 fema…  2007\n 2 Adelie  Biscoe           40.5          17.9           187    3200 fema…  2007\n 3 Adelie  Biscoe           37.9          18.6           172    3150 fema…  2007\n 4 Adelie  Biscoe           35            17.9           190    3450 fema…  2008\n 5 Adelie  Biscoe           34.5          18.1           187    2900 fema…  2008\n 6 Adelie  Biscoe           36.5          16.6           181    2850 fema…  2008\n 7 Adelie  Biscoe           35.7          16.9           185    3150 fema…  2008\n 8 Adelie  Biscoe           36.4          17.1           184    2850 fema…  2008\n 9 Adelie  Biscoe           35.5          16.2           195    3350 fema…  2008\n10 Adelie  Biscoe           37.7          16             183    3075 fema…  2009\n11 Adelie  Biscoe           37.9          18.6           193    2925 fema…  2009\n12 Adelie  Biscoe           38.1          17             181    3175 fema…  2009\n13 Adelie  Biscoe           39.7          17.7           193    3200 fema…  2009\n# … with abbreviated variable names ¹​flipper_length_mm, ²​body_mass_g\n```\n:::\n:::\n\n\n### Exercises\n\n1. Try all of the following with `filter()`:\n    - Filter penguins that reside on Torgersen island.\n    - Filter penguins that have a flipper length greater than 185 mm.\n    - Filter penguins that reside on Torgersen island and have a body mass less than 3500 g. \n2. Try filtering the DartPoints dataset.\n    - Filter darts that \n\n## Groups\n\nYour data will often include natural groupings (like species in the penguins table or dart types in the darts table), and you will want to summarize information about each of those groups. The way that you do this with `dplyr` involves the use of `group_by()` and `summarize()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> group_by(species)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 8\n# Groups:   species [3]\n   species island    bill_length_mm bill_depth_mm flipper_…¹ body_…² sex    year\n   <fct>   <fct>              <dbl>         <dbl>      <int>   <int> <fct> <int>\n 1 Adelie  Torgersen           39.1          18.7        181    3750 male   2007\n 2 Adelie  Torgersen           39.5          17.4        186    3800 fema…  2007\n 3 Adelie  Torgersen           40.3          18          195    3250 fema…  2007\n 4 Adelie  Torgersen           NA            NA           NA      NA <NA>   2007\n 5 Adelie  Torgersen           36.7          19.3        193    3450 fema…  2007\n 6 Adelie  Torgersen           39.3          20.6        190    3650 male   2007\n 7 Adelie  Torgersen           38.9          17.8        181    3625 fema…  2007\n 8 Adelie  Torgersen           39.2          19.6        195    4675 male   2007\n 9 Adelie  Torgersen           34.1          18.1        193    3475 <NA>   2007\n10 Adelie  Torgersen           42            20.2        190    4250 <NA>   2007\n# … with 334 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#   ²​body_mass_g\n```\n:::\n:::\n\n\nNotice that the data are not changed, but the tibble now includes information about the groupings (_Groups: species [3]_). Now, if you apply `summarize()` to it, it will know that you want summaries for each group.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  group_by(species) |> \n  summarize(\n    mean_bill_length = mean(bill_length_mm, na.rm = TRUE),\n    var_bill_length = var(bill_length_mm, na.rm = TRUE)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  species   mean_bill_length var_bill_length\n  <fct>                <dbl>           <dbl>\n1 Adelie                38.8            7.09\n2 Chinstrap             48.8           11.2 \n3 Gentoo                47.5            9.50\n```\n:::\n:::\n\n\nNote that you can summarize by multiple groups.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  group_by(species, island) |> \n  summarize(\n    mean_bill_length = mean(bill_length_mm, na.rm = TRUE),\n    var_bill_length = var(bill_length_mm, na.rm = TRUE)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 4\n# Groups:   species [3]\n  species   island    mean_bill_length var_bill_length\n  <fct>     <fct>                <dbl>           <dbl>\n1 Adelie    Biscoe                39.0            6.15\n2 Adelie    Dream                 38.5            6.08\n3 Adelie    Torgersen             39.0            9.15\n4 Chinstrap Dream                 48.8           11.2 \n5 Gentoo    Biscoe                47.5            9.50\n```\n:::\n:::\n\n\nA handy little function you will often want to use in summaries is `n()`. This counts the number of observations in each group.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  group_by(species, island) |> \n  summarize(\n    count = n(),\n    mean_bill_length = mean(bill_length_mm, na.rm = TRUE),\n    var_bill_length = var(bill_length_mm, na.rm = TRUE)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 5\n# Groups:   species [3]\n  species   island    count mean_bill_length var_bill_length\n  <fct>     <fct>     <int>            <dbl>           <dbl>\n1 Adelie    Biscoe       44             39.0            6.15\n2 Adelie    Dream        56             38.5            6.08\n3 Adelie    Torgersen    52             39.0            9.15\n4 Chinstrap Dream        68             48.8           11.2 \n5 Gentoo    Biscoe      124             47.5            9.50\n```\n:::\n:::\n\n\nNow, suppose you wanted to get the three penguins in each species with the longest bills. To do that, you can apply the `slice_max()` function to the grouped penguins table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  group_by(species) |> \n  slice_max(bill_length_mm, n = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9 × 8\n# Groups:   species [3]\n  species   island    bill_length_mm bill_depth_mm flipper…¹ body_…² sex    year\n  <fct>     <fct>              <dbl>         <dbl>     <int>   <int> <fct> <int>\n1 Adelie    Torgersen           46            21.5       194    4200 male   2007\n2 Adelie    Torgersen           45.8          18.9       197    4150 male   2008\n3 Adelie    Biscoe              45.6          20.3       191    4600 male   2009\n4 Chinstrap Dream               58            17.8       181    3700 fema…  2007\n5 Chinstrap Dream               55.8          19.8       207    4000 male   2009\n6 Chinstrap Dream               54.2          20.8       201    4300 male   2008\n7 Gentoo    Biscoe              59.6          17         230    6050 male   2007\n8 Gentoo    Biscoe              55.9          17         228    5600 male   2009\n9 Gentoo    Biscoe              55.1          16         230    5850 male   2009\n# … with abbreviated variable names ¹​flipper_length_mm, ²​body_mass_g\n```\n:::\n:::\n\n\nYou can also get a random sample from each group (known as a stratified random sample) with `slice_sample()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  group_by(species) |> \n  slice_sample(n = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9 × 8\n# Groups:   species [3]\n  species   island    bill_length_mm bill_depth_mm flipper…¹ body_…² sex    year\n  <fct>     <fct>              <dbl>         <dbl>     <int>   <int> <fct> <int>\n1 Adelie    Torgersen           41.5          18.3       195    4300 male   2009\n2 Adelie    Torgersen           37.7          19.8       198    3500 male   2009\n3 Adelie    Biscoe              39            17.5       186    3550 fema…  2008\n4 Chinstrap Dream               45.7          17.3       193    3600 fema…  2009\n5 Chinstrap Dream               47.5          16.8       199    3900 fema…  2008\n6 Chinstrap Dream               46.8          16.5       189    3650 fema…  2009\n7 Gentoo    Biscoe              44.5          14.7       214    4850 fema…  2009\n8 Gentoo    Biscoe              45.5          15         220    5000 male   2008\n9 Gentoo    Biscoe              46.3          15.8       215    5050 male   2007\n# … with abbreviated variable names ¹​flipper_length_mm, ²​body_mass_g\n```\n:::\n:::\n\n\nSome other useful `slice_*()` functions include the following\n\n- `slice_head(n)` takes the first n rows in each group.\n- `slice_tail(n)` takes the last n rows in each group.\n- `slice_min(x, n)` takes the n rows with the smallest values of x.\n- `slice_max(x, n)` takes the n rows with the largest value of x.\n- `slice_sample(n)` takes n random rows in each group.\n\n### Exercises\n\n1. Group the penguins data by species and summarize the mean flipper length.\n2. Group the penguins data by island and count the number of penguins on each. Hint: you can use `n()` to do this.\n2. Group the penguins data by sex and summarize the mean and variance in body mass.\n2. Group the penguins data by sex and species and summarize the mean and variance in body mass.\n2. Group the darts data by type and summarize the mean length, width, and height.\n2. Group the darts data by type and take a random sample of length five from each group.\n2. Remove any potential duplicates from the darts data with `distinct()`.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}