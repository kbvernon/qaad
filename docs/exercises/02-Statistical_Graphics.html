<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 02</title>

<script src="02-Statistical_Graphics_files/header-attrs/header-attrs.js"></script>
<script src="02-Statistical_Graphics_files/jquery/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<link href="02-Statistical_Graphics_files/bootstrap/bootstrap.min.css" rel="stylesheet" />
<script src="02-Statistical_Graphics_files/bootstrap/bootstrap.bundle.min.js"></script>
<script src="02-Statistical_Graphics_files/bs3compat/transition.js"></script>
<script src="02-Statistical_Graphics_files/bs3compat/tabs.js"></script>
<script src="02-Statistical_Graphics_files/bs3compat/bs3compat.js"></script>
<script src="02-Statistical_Graphics_files/jqueryui/jquery-ui.min.js"></script>
<link href="02-Statistical_Graphics_files/tocify/jquery.tocify.css" rel="stylesheet" />
<script src="02-Statistical_Graphics_files/tocify/jquery.tocify.js"></script>
<script src="02-Statistical_Graphics_files/navigation/tabsets.js"></script>
<link href="02-Statistical_Graphics_files/highlightjs/default.css" rel="stylesheet" />
<script src="02-Statistical_Graphics_files/highlightjs/highlight.js"></script>
<script src="02-Statistical_Graphics_files/clipboard/clipboard.min.js"></script>
<link href="02-Statistical_Graphics_files/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="02-Statistical_Graphics_files/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"Press Ctrl+C to Copy"})</script>
<link href="02-Statistical_Graphics_files/font-awesome/css/all.css" rel="stylesheet" />
<link href="02-Statistical_Graphics_files/font-awesome/css/v4-shims.css" rel="stylesheet" />

<script type="text/javascript">

  $(document).ready(function () {
    
    const ttl = $('.title.toc-ignore').text();
    const subttl = $('.subtitle').text();
    
    $('.title.toc-ignore').remove();
    $('.subtitle').remove();
    
    $('<h1 class = "title toc-ignore">' + ttl + '</h1><h3 class = "subtitle">' + subttl + '</h3>')
      .appendTo('.tocify');
    
    $('.section.level2:first').show();
      
  });
  
  $(window).on('load', function() {
  
    $('.tocify-item.list-group-item').click(function(event){
        
      $('.section.level2').hide();
      
      var id = $(this).data('unique');
      
      $('#'+id).show(100, function(){
        $('html').scrollTop(0);
      });
      
    });
  
  });

</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">Lab 02</h1>
<h3 class="subtitle">Statistical Graphics</h3>

</div>


<div id="Outline" class="section level2">
<h2>Outline</h2>
<p><strong>tl;dr</strong> summary statistics and statistical graphics.</p>
<div id="objectives" class="section level3">
<h3>Objectives</h3>
<p>This lab will guide you through the process of</p>
<ol style="list-style-type: decimal">
<li>loading (or “attaching”) R packages with <code>library()</code></li>
<li>generating summary statistics for your data</li>
<li>visualizing data with the grammar of graphics (gg)
<ul>
<li>aesthetic mappings</li>
<li>geometric objects</li>
<li>facets</li>
<li>scales</li>
<li>themes</li>
</ul></li>
</ol>
</div>
<div id="r-packages" class="section level3">
<h3>R Packages</h3>
<p>We will be using the following packages:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/archdata/index.html">archdata</a></li>
<li><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></li>
<li><a href="https://docs.ropensci.org/skimr/">skimr</a></li>
<li><a href="https://ggplot2.tidyverse.org/index.html">ggplot2</a></li>
<li><a href="https://sjmgarnier.github.io/viridis/">viridis</a></li>
</ul>
<p>To install these packages, run the following code in your console:</p>
<pre class="r"><code>install.packages(
  c(&quot;archdata&quot;, &quot;palmerpenguins&quot;, &quot;skimr&quot;, &quot;ggplot2&quot;, &quot;viridis&quot;)
)</code></pre>
</div>
<div id="data" class="section level3">
<h3>Data</h3>
<ul>
<li><code>penguins</code>
<ul>
<li>Includes measurements for penguin species, island in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and sex.</li>
<li>package: <code>palmerpenguins</code></li>
<li>reference: <a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html" class="uri">https://allisonhorst.github.io/palmerpenguins/reference/penguins.html</a></li>
</ul></li>
<li><code>DartPoints</code>
<ul>
<li>Includes measurements of 91 Archaic dart points recovered during surface surveys at Fort Hood, Texas.</li>
<li>package: <code>archdata</code></li>
<li>reference: <a href="https://cran.r-project.org/web/packages/archdata/archdata.pdf" class="uri">https://cran.r-project.org/web/packages/archdata/archdata.pdf</a></li>
</ul></li>
</ul>
</div>
</div>
<div id="The_Library" class="section level2">
<h2>The Library</h2>
<p>R is an extensible programming language, meaning you can write R code to extend the functionality of base R. To share that code, R users will often bundle it into a <strong>package</strong>, a collection of functions, data, and documentation. You can think of packages like apps, but specifically for R. To make the functionality a package offers available in R, you have to load them in with the <code>library()</code> function (the technical term is <em>attach</em>).</p>
<p>You will occasionally encounter <code>library()</code> calls littered throughout an R script or R Markdown document. DO NOT DO THIS. You should always, always, always load all the packages you use at the beginning of a document. That way, people who read your code know exactly what packages you are using all at once and right away. To make this really, really explicit, I prefer to set this off with its own section that I call the “R Preamble.” In an R script, it looks like this:</p>
<pre class="r"><code># R PREAMBLE --------------------------------------------------------------

library(archdata)
library(ggplot2)
library(palmerpenguins)
library(skimr)
library(viridis)</code></pre>
<p>And in an R Markdown document, it looks like this:</p>
<pre class="md"><code>---
title: &quot;Week 02&quot;
author: &quot;Kenneth Blake Vernon&quot;
date: &quot;1/18/2022&quot;
output: html_document
---

```{r setup, include = FALSE}

knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE
)

```

## R Preamble

```{r packages}

library(archdata)
library(ggplot2)
library(palmerpenguins)
library(skimr)
library(viridis)

```

***

## Lab Exercises


***

## Homework Exercises

1. 
</code></pre>
<p>Note that in an R script, the hashtag <code>#</code> tells R that the text that follows on the same line is not R code, but rather a comment. In an R Markdown document, it is markdown syntax that signals a section header. Another important difference is that you have to put the <code>library()</code> calls in a code chunk in R Markdown to signal that it is R code. In an R script, however, everything is assumed to be R code.</p>
<div id="exercises" class="section level3">
<h3>Exercises</h3>
<ol style="list-style-type: decimal">
<li>Open a new R Markdown document for this lab and copy the template above into that document, replacing the author with your name.</li>
<li>Run each <code>library()</code> call, either by highlighting them and hitting Ctrl + Enter (Cmd + Enter) or by clicking the green arrow in the top right of the code chunk.</li>
</ol>
</div>
</div>
<div id="Summary_Statistics" class="section level2">
<h2>Summary Statistics</h2>
<div class="figure" style="text-align: center">
<img src="https://allisonhorst.github.io/palmerpenguins/reference/figures/culmen_depth.png" alt="Artwork by @allison_horst" width="70%" />
<p class="caption">
Artwork by <span class="citation">@allison_horst</span>
</p>
</div>
<p>Let’s use R to describe some properties of a sample of penguins from Palmer Station in Antarctica. These data became available in R when you loaded the <code>palmerpenguins</code> package. They aren’t currently visible in your environment (for complicated reasons), but trust me, they’re there. The name of the dataset is <code>penguins</code>, so you can call it that way.</p>
<pre class="r"><code>head(penguins, n = 5)
## # A tibble: 5 x 8
##   species island bill_length_mm bill_depth_mm flipper_length_~ body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Torge~           39.1          18.7              181        3750 male 
## 2 Adelie  Torge~           39.5          17.4              186        3800 fema~
## 3 Adelie  Torge~           40.3          18                195        3250 fema~
## 4 Adelie  Torge~           NA            NA                 NA          NA &lt;NA&gt; 
## 5 Adelie  Torge~           36.7          19.3              193        3450 fema~
## # ... with 1 more variable: year &lt;int&gt;</code></pre>
<div id="central-tendency" class="section level3">
<h3>Central tendency</h3>
<p>The central tendency is, as its name suggests, a value around which other values tend to cluster. There are two primary measures of central tendency: the mean and the median. As you may recall, the mean or average is simply the sum of a finite set of values, <span class="math inline">\(x_i\)</span>, divided by the number of values, <span class="math inline">\(n\)</span>.</p>
<p><span class="math display">\[\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i\]</span> This is the sample mean, which is an estimate of the central tendency of a population, <span class="math inline">\(\mu\)</span>. In R, you can calculate the mean by hand if you like, but it’s probably easier to use the built-in R function, <code>mean()</code>. Let’s use this to calculate the mean bill length of penguins.</p>
<pre class="r"><code>mean(penguins$bill_length_mm)
## [1] NA</code></pre>
<p>Whoops! Need to set <code>na.rm = TRUE</code> to ignore missing values.</p>
<pre class="r"><code>mean(penguins$bill_length_mm, na.rm = TRUE)
## [1] 43.92193</code></pre>
<p>An important limitation of the mean is its sensitivity to outliers, like rich people. If you calculate the mean household income in the United States, for example, the incomes of obscenely wealthy individuals like Jeff Bezos will pull that measure up, thus painting a much rosier picture of the US than the reality the rest of us live in. To address this, you should use the median as it is the “middle” number or value that evenly divides the sample in half.</p>
<pre class="r"><code>median(penguins$bill_length_mm, na.rm = TRUE)
## [1] 44.45</code></pre>
</div>
<div id="dispersion" class="section level3">
<h3>Dispersion</h3>
<p>Dispersion describes the spread of data around its central tendency. Are the values tightly clustered around the central tendency or highly dispersed? Is there, in other words, a lot of variability? This is what dispersion seeks to characterize. As with the central tendency, it has two primary measures: variance and standard deviation. The variance of a sample is the mean squared error.</p>
<p><span class="math display">\[s^{2} = \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^{2}\]</span> This is an estimate of the population variance, <span class="math inline">\(\sigma^2\)</span>. To calculate the variance of a sample with R, use <code>var()</code>.</p>
<pre class="r"><code>var(penguins$body_mass_g, na.rm = TRUE)
## [1] 643131.1</code></pre>
<p>Whoa! That’s a really big number. Do penguins get that big? The answer, of course, is No. The number is large because variance is <em>squared</em> error, so this is in units of squared-grams, <span class="math inline">\(g^2\)</span>, not grams, <span class="math inline">\(g\)</span>. That makes it a really weird measure to think about. That’s why it is common to take the square root of the variance, to get the measure back into units of the data. This value is known as the standard deviation, <span class="math inline">\(s\)</span>. You can calculate it with the <code>sd()</code> function.</p>
<pre class="r"><code>sd(penguins$body_mass_g, na.rm = TRUE)
## [1] 801.9545</code></pre>
<p>That’s about 1.8 pounds (if you prefer Imperial units).</p>
</div>
<div id="table-summaries" class="section level3">
<h3>Table summaries</h3>
<p>Base R has a really nice <code>summary()</code> function that you can apply to a table like so:</p>
<pre class="r"><code>summary(penguins)
##       species          island    bill_length_mm  bill_depth_mm  
##  Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  
##  Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  
##  Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  
##                                  Mean   :43.92   Mean   :17.15  
##                                  3rd Qu.:48.50   3rd Qu.:18.70  
##                                  Max.   :59.60   Max.   :21.50  
##                                  NA&#39;s   :2       NA&#39;s   :2      
##  flipper_length_mm  body_mass_g       sex           year     
##  Min.   :172.0     Min.   :2700   female:165   Min.   :2007  
##  1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007  
##  Median :197.0     Median :4050   NA&#39;s  : 11   Median :2008  
##  Mean   :200.9     Mean   :4202                Mean   :2008  
##  3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009  
##  Max.   :231.0     Max.   :6300                Max.   :2009  
##  NA&#39;s   :2         NA&#39;s   :2</code></pre>
<p>As you can see, this prints out summary statistics for the variables in your data. However, the printout is not easy to read and it provides a somewhat limited set of summary statistics. So, as an alternative, I would recommend the <code>skim()</code> function from the <code>skimr</code> package.</p>
<pre class="r"><code>skim(penguins)
## -- Data Summary ------------------------
##                            Values  
## Name                       penguins
## Number of rows             344     
## Number of columns          8       
## _______________________            
## Column type frequency:             
##   factor                   3       
##   numeric                  5       
## ________________________           
## Group variables            None    
## 
## -- Variable type: factor -------------------------------------------------------
## # A tibble: 3 x 6
##   skim_variable n_missing complete_rate ordered n_unique
## * &lt;chr&gt;             &lt;int&gt;         &lt;dbl&gt; &lt;lgl&gt;      &lt;int&gt;
## 1 species               0         1     FALSE          3
## 2 island                0         1     FALSE          3
## 3 sex                  11         0.968 FALSE          2
##   top_counts                 
## * &lt;chr&gt;                      
## 1 Ade: 152, Gen: 124, Chi: 68
## 2 Bis: 168, Dre: 124, Tor: 52
## 3 mal: 168, fem: 165         
## 
## -- Variable type: numeric ------------------------------------------------------
## # A tibble: 5 x 11
##   skim_variable     n_missing complete_rate   mean      sd     p0    p25    p50
## * &lt;chr&gt;                 &lt;int&gt;         &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 bill_length_mm            2         0.994   43.9   5.46    32.1   39.2   44.4
## 2 bill_depth_mm             2         0.994   17.2   1.97    13.1   15.6   17.3
## 3 flipper_length_mm         2         0.994  201.   14.1    172    190    197  
## 4 body_mass_g               2         0.994 4202.  802.    2700   3550   4050  
## 5 year                      0         1     2008.    0.818 2007   2007   2008  
##      p75   p100 hist 
## *  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1   48.5   59.6 &lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2581&gt;
## 2   18.7   21.5 &lt;U+2585&gt;&lt;U+2585&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2582&gt;
## 3  213    231   &lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2585&gt;&lt;U+2582&gt;
## 4 4750   6300   &lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2583&gt;&lt;U+2582&gt;
## 5 2009   2009   &lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2587&gt;</code></pre>
<p>As you can see, there are three major sections of this printout: (i) Data Summary, (ii) Factor variables, and (iii) Numeric variables. The Data Summary gives you an overview of your table, with counts of the number of rows and columns, as well as counts of the different types of variables (factor, numeric, etc). The section on factor variables gives you counts for each level of the factor (for example, counts of the different species of penguins), as well as information about missing data. Finally, the section on numeric variables gives you information on missing data, as well as measures of dispersion and central tendency, including the mean, median (<code>p50</code>), and standard deviation (<code>sd</code>), the range or min and max values (<code>p0</code> and <code>p100</code>), and the inner quartiles (<code>p25</code> and <code>p75</code>).</p>
</div>
<div id="exercises-1" class="section level3">
<h3>Exercises</h3>
<ol style="list-style-type: decimal">
<li>Have a look at the <code>penguins</code> data again. Use <code>head()</code> to preview the first 15 rows.</li>
<li>With the <code>penguins</code> data, calculate all of the following:
<ul>
<li>median body mass</li>
<li>mean bill depth</li>
<li>variance in bill depth</li>
<li>standard deviation in bill length</li>
</ul></li>
</ol>
</div>
</div>
<div id="The_Grammar_of_Graphics" class="section level2">
<h2>The Grammar of Graphics</h2>
<p>It’s easy to imagine how you would go about with pen and paper drawing a bar chart of, say, the number of penguins in each species in the <code>penguins</code> dataset. But, what if you had to dictate the steps to make that graph to another person, one you can’t see or physically interact with? All you can do is use words to communicate the graphic you want. How would you do it? Regardless of how you answer that question, you should see right away that one thing is essential. You and your illustrator must share a coherent vocabulary for describing graphics. That way you can unambiguously communicate your intent. That’s essentially what the grammar of graphics is, a language with a set of rules (a grammar) for specifying each component of a graphic.</p>
<p>In R, the <code>ggplot2</code> package provides an elegant implementation of the grammar of graphics, and that’s what we’ll be using here. Basically, R is your illustrator, and <code>ggplot2</code> is the language you are going to speak to R to make your graphics. So, how do we do that? Well, let’s start with the basics. Suppose we want to know if there’s some kind of relationship (an allometric relationship) among the Palmer Station penguins between their body mass and bill length. Here’s how we would visualize that.</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  )</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here, we have created what is known as a <strong>scatterplot</strong>, a representation of the raw data as points on a Cartesian grid. There are several things to note about the code used to generate this plot.</p>
<ol style="list-style-type: decimal">
<li>First, it begins with a call to the <code>ggplot()</code> function. This takes a <code>data</code> argument. In this case, we say that we want to make a plot to visualize the penguins data.</li>
<li>The next function call is <code>geom_point()</code>. This is a way of specifying the geometry we want to plot. Here we chose points, but we could have used another choice (lines, for example, or polygons).</li>
<li>Note that the <code>geom_point()</code> call takes a <code>mapping</code> argument. You use this to specify how variables in your data are mapped to properties of the graphic. Here, we chose to map the <code>body_mass_g</code> variable to the x-coordinates and the <code>bill_length_mm</code> variable to the y-coordinates. Importantly, we use the <code>aes()</code> function to supply an aesthetic to the mapping parameter. This is always the case.</li>
<li>The final thing to point out here is that we combined or connected these arguments using the plus-sign, <code>+</code>. You should read this literally as <em>addition</em>, as in “make this ggplot of the penguins data and add a point geometry to it.” Be aware that the use of the plus-sign in this way is unique to the <code>ggplot2</code> package and won’t work with other graphical tools in R.</li>
</ol>
<p>We can summarize these ideas with a simple template. All that is required to make a graph in R is to replace the elements in the bracketed sections with a dataset, a geometry function, and an aesthetic mapping.</p>
<pre class="r"><code>ggplot(data = &lt;DATA&gt;) + 
  &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;))</code></pre>
<p>One of the great things about ggplot, something that makes it stand out compared to alternative graphics engines in R, is that you can assign plots to a variable and call it in different places, or modify it as needed.</p>
<pre class="r"><code>penguins_plot &lt;- ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  )

penguins_plot</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="exercises-2" class="section level3">
<h3>Exercises</h3>
<ol style="list-style-type: decimal">
<li>Recreate the scatterplot above, but switch the axes. Put bill length on the x-axis and body mass on the y-axis.</li>
<li>Fill in the template above to create a scatterplot of bill length (on the y-axis) by bill depth (on the x-axis).</li>
</ol>
</div>
</div>
<div id="Aesthetics" class="section level2">
<h2>Aesthetics</h2>
<p>In the plot above, we only specified the position of the points (the x- and y-coordinates) in the aesthetic mapping, but there are many aesthetics (see the figure below), and we can map the same or other variables to those.</p>
<div class="figure" style="text-align: center">
<img src="https://clauswilke.com/dataviz/aesthetic_mapping_files/figure-html/common-aesthetics-1.png" alt="Commonly used aesthetics. Figure from [Claus O. Wilke. Fundamentals of Data Visualization. O'Reilly, 2019.](https://clauswilke.com/dataviz)" width="60%" />
<p class="caption">
Commonly used aesthetics. Figure from <a href="https://clauswilke.com/dataviz">Claus O. Wilke. Fundamentals of Data Visualization. O’Reilly, 2019.</a>
</p>
</div>
<p>Consider, for example, the fact that there are three penguin species in our dataset: Adelie, Gentoo, and Chinstrap. Do we think the relationship between body mass and bill length holds for all of them? Let’s add penguin species to our aesthetic mapping (specifically to the <code>color</code> parameter) and see what happens.</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  )</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that ggplot2 automatically assigns a unique color to each species and adds a legend to the right that explains each color. In this way, the color doesn’t just change the look of the figure. It conveys information about the data. Rather than mapping a variable in the data to a specific aesthetic, though, we can also define an aesthetic manually for the geometry as a whole. In this case, the aesthetics do not convey information about the data. They merely change the look of the figure. The key to doing this is to move the specification outside the <code>aes()</code>, but still inside the <code>geom_point()</code> function.</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm),
    shape = 21,
    size = 4,
    color = &quot;darkred&quot;,
    fill = &quot;darkgoldenrod1&quot;
  )</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that we specified the shape with a number. R has 25 built-in shapes that you can specify with a number, as shown in the figure below. Some important differences in these shapes concern the border and fill colors. The hollow shapes (0-14) have a border that you specify with with <code>color</code>, the solid shapes (15-20) have a border and fill, both specified with <code>color</code>, and the filled shapes (21-24) have separate border and fill colors, specified with <code>color</code> and <code>fill</code> respectively.</p>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div id="exercises-3" class="section level3">
<h3>Exercises</h3>
<ol style="list-style-type: decimal">
<li>Change the code below to map the <code>species</code> variable to the x-axis (in addition to the color).</li>
</ol>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  )</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>What does this do to the position of the points?</p></li>
<li><p>Change the code below to map the <code>species</code> variable to the shape aesthetic (in addition to the color).</p></li>
</ol>
<pre class="r"><code># hint: use shape = ...
ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  )</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Change the code below to map the <code>species</code> variable to the size aesthetic (replacing color).</li>
</ol>
<pre class="r"><code># hint: use size = ...
ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  )</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>For the following code, change the color, size, and shape aesthetics for the entire geometry (do not map them to the data).</li>
</ol>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm),
    color = , # &lt;------- insert value here
    size = ,  # &lt;------- 
    shape =   # &lt;------- 
  )</code></pre>
</div>
</div>
<div id="Geometries" class="section level2">
<h2>Geometries</h2>
<p>Have a look at these two plots.</p>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-26-1.png" width="50%" /><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-26-2.png" width="50%" /></p>
<p>Both represent the same data, the same x and y variables, but they do so in very different ways. That difference concerns their different <strong>geometries</strong>. These are geometrical objects used to represent the data. To change the geometry, simply change the <code>geom_*()</code> function. For example, to create the plots above, use the <code>geom_point()</code> and <code>geom_smooth()</code> functions.</p>
<pre class="r"><code># left
ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  )

# right
ggplot(data = penguins) + 
  geom_smooth(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  )</code></pre>
<p>While every geometry function takes a <code>mapping</code> argument, not every aesthetic works (or is needed) for every geometry. For example, there’s no <code>shape</code> aesthetic for lines, but there is a <code>linetype</code>. Conversely, points have a <code>shape</code>, but not a <code>linetype</code>.</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_smooth(
    mapping = aes(x = body_mass_g, y = bill_length_mm, linetype = species),
  )</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>One really important thing to note here is that you can add multiple geometries to the same plot to represent the same data. Simply add them together with <code>+</code>.</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_smooth(
    mapping = aes(x = body_mass_g, y = bill_length_mm, linetype = species),
  ) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  )</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>That’s a hideous figure, though it should get the point across. While layering in this way is a really powerful tool for visualizing data, it does have one important drawback. Namely, it violates the DRY principle (Don’t Repeat Yourself), as it specifies the x and y variables twice. This makes it harder to make changes, forcing you to edit the same aesthetic parameters in multiple locations. To avoid this, <code>ggplot2</code> allows you to specify a common set of aesthetic mappings in the <code>ggplot()</code> function itself. These will then apply globally to all the geometries in the figure.</p>
<pre class="r"><code>ggplot(
  data = penguins,
  mapping = aes(x = body_mass_g, y = bill_length_mm)
) +
  geom_smooth(mapping = aes(linetype = species)) +
  geom_point(mapping = aes(color = species))</code></pre>
<p>Notice that you can still specify specific aesthetic mappings in each geometry function. These will apply only <em>locally</em> to that specific geometry rather than <em>globally</em> to all geometries in the plot. In the same way, you can specify different <code>data</code> for each geometry.</p>
<pre class="r"><code>ggplot(
  data = penguins,
  mapping = aes(x = body_mass_g, y = bill_length_mm)
) +
  geom_smooth(data = filter(penguins, species == &quot;Adelie&quot;)) +
  geom_point(mapping = aes(color = species))</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-31-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Some of the more important geometries you are likely to use include:</p>
<ul>
<li><code>geom_point()</code></li>
<li><code>geom_line()</code></li>
<li><code>geom_segment()</code></li>
<li><code>geom_polygon()</code></li>
<li><code>geom_boxplot()</code></li>
<li><code>geom_histogram()</code></li>
<li><code>geom_density()</code></li>
</ul>
<p>We’ll actually cover those last three in the section on plotting distributions. For a complete list of available geometries, see the <a href="https://ggplot2.tidyverse.org/reference/index.html#section-layers">layers section</a> of the ggplot2 website reference page.</p>
</div>
<div id="Facets" class="section level2">
<h2>Facets</h2>
<p>Sometimes mapping variables to aesthetics can generate a lot of noise and clutter, making it hard to read or interpret a figure. One way to handle this is to split your plot into multiple plots or <strong>facets</strong> based on levels of a categorical variable like <code>species</code>. To do this for one categorical variable, you use the <code>facet_wrap()</code> function.</p>
<pre class="r"><code>ggplot(data = penguins) +
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  ) +
  facet_wrap(~ species)</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The tilde, <code>~</code>, can be read as “by”, as in “split the plot <em>by species</em>.” If you want to split the plot by two categorical variables, like <code>species</code> and <code>sex</code>, use the <code>facet_grid()</code> function.</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  ) +
  facet_grid(sex ~ species)</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Evidently, there are some penguins for whom the sex is unknown. To remove these penguins from the dataset, you can use the <code>na.omit()</code> function.</p>
<pre class="r"><code>ggplot(data = na.omit(penguins)) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  ) +
  facet_grid(sex ~ species)</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-34-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="exercises-4" class="section level3">
<h3>Exercises</h3>
<ol style="list-style-type: decimal">
<li>use <code>facet_wrap()</code> to split the following scatterplot of the penguins data by sex.</li>
</ol>
<pre class="r"><code>ggplot(data = na.omit(penguins)) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  ) + 
  facet_wrap() # &lt;------- insert value here</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Now, map the <code>species</code> to the color aesthetic for the point geometry.</p></li>
<li><p>Use <code>facet_grid()</code> to split the following scatterplot of the penguins data by species and island.</p></li>
</ol>
<pre class="r"><code>ggplot(data = na.omit(penguins)) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  ) + 
  facet_grid() # &lt;------- insert value here</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>What does this tell you about how species are distributed across islands?</li>
</ol>
</div>
</div>
<div id="Scales" class="section level2">
<h2>Scales</h2>
<p>Scales provide the basic structure that determines how data values get mapped to visual properties in a graph. The most obvious example is the axes because these determine where things will be located in the graph, but color scales are also important if you want your figure to provide additional information about your data. Here, we will briefly cover two aspects of scales that you will often want to change: axis labels and color palettes, in particular palettes that are colorblind safe.</p>
<div id="labels" class="section level3">
<h3>Labels</h3>
<p>By default, <code>ggplot2</code> uses the names of the variables in the data to label the axes. This, however, can lead to poor graphics as naming conventions in R are not the same as those you might want to use to visualize your data. Fortunately, <code>ggplot2</code> provides tools for renaming the axis and plot titles. The one you are likely to use most often is probably the <code>labs()</code> function. Here is a standard usage:</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm)
  ) +
  labs(
    x = &quot;Body mass (g)&quot;,
    y = &quot;Bill length (mm)&quot;,
    title = &quot;Palmer Penguins&quot;
  )</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-37-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="color-palettes" class="section level3">
<h3>Color Palettes</h3>
<p>When you map a variable to an aesthetic property, <code>ggplot2</code> will supply a default color palette. This is fine if you are just wanting to explore the data yourself, but when it comes to publication-ready graphics, it won’t do. That’s because the default <code>ggplot2</code> color palette is not colorblind safe. To address this shortcoming, you can specify colorblind safe color palettes using the <code>scale_color_viridis()</code> function from the <code>viridis</code> package. It works like this:</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  ) +
  labs(
    x = &quot;Body mass (g)&quot;,
    y = &quot;Bill length (mm)&quot;,
    title = &quot;Palmer Penguins&quot;
  ) +
  scale_color_viridis(
    option = &quot;viridis&quot;, 
    discrete = TRUE
  )</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-39-1.png" width="50%" /><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-39-2.png" width="50%" /></p>
<p>For comparison, I’m showing the viridis scale next to the default ggplot2 scale, so you can see the difference. Two things to note about <code>scale_color_viridis()</code>. First, you choose a specific colorblind safe palette with the <code>option</code> parameter. In this case, I chose <code>viridis</code>, but there are others, including <code>magma</code>, <code>cividis</code>, and <code>inferno</code>, to name a few. Second, if the variable is continuous rather than discrete, you will have to set <code>discrete = FALSE</code> in the function, otherwise it will throw an error.</p>
</div>
<div id="exercises-5" class="section level3">
<h3>Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Using the <code>penguins</code> dataset, plot body mass (y variable) by bill length (x variable) and change the axis labels to reflect this.</p></li>
<li><p>Using the <code>penguins</code> dataset, plot bill length (y variable) by bill depth (x variable) and change the axis labels to reflect this.</p></li>
<li><p>Using the code below, try out these different colorblind safe palettes:</p>
<ul>
<li>magma</li>
<li>cividis</li>
<li>inferno</li>
</ul></li>
</ol>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  ) +
  labs(
    x = &quot;Body mass (g)&quot;,
    y = &quot;Bill length (mm)&quot;,
    title = &quot;Palmer Penguins&quot;
  ) +
  scale_color_viridis(
    option = , # &lt;------- insert value here
    discrete = TRUE
  )</code></pre>
</div>
</div>
<div id="Themes" class="section level2">
<h2>Themes</h2>
<p>To control the display of non-data elements in a figure, you can specify a theme. This is done with the <code>theme()</code> function. Using this can get pretty complicated, pretty quick, so rather than elaborate on it in detail, I want to draw your attention to pre-defined themes that you can use to modify your plots in a consistent way.</p>
<p>Here is an example of the black and white theme, which removes filled background grid squares, leaving only the grid lines.</p>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  ) +
  labs(
    x = &quot;Body mass (g)&quot;,
    y = &quot;Bill length (mm)&quot;,
    title = &quot;Palmer Penguins&quot;
  ) +
  theme_bw()</code></pre>
<p><img src="02-Statistical_Graphics_files/figure-html/unnamed-chunk-41-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="exercises-6" class="section level3">
<h3>Exercises</h3>
<ol style="list-style-type: decimal">
<li>Complete the code below, trying out each separate theme:
<ul>
<li><code>theme_minimal()</code></li>
<li><code>theme_classic()</code></li>
<li><code>theme_void()</code></li>
</ul></li>
</ol>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(
    mapping = aes(x = body_mass_g, y = bill_length_mm, color = species)
  ) +
  labs(
    x = &quot;Body mass (g)&quot;,
    y = &quot;Bill length (mm)&quot;,
    title = &quot;Palmer Penguins&quot;
  ) +
  theme_    # &lt;------- insert value here</code></pre>
</div>
</div>
<div id="Homework" class="section level2">
<h2>Homework</h2>
<ol style="list-style-type: decimal">
<li><strong>Load data.</strong> For this homework exercise, we’ll work with the <code>DartPoints</code> dataset from the <code>archdata</code> package. When you ran <code>library(archdata)</code>, this dataset should have been attached to your current R session, so don’t worry about loading it into R. It’s already there!</li>
<li><strong>Summary statistics.</strong> Let’s summarize these data now.
<ul>
<li>Use <code>head()</code> to print out the first 10 rows of the table.</li>
<li>Use <code>mean()</code> and <code>median()</code> on the <code>Length</code>, <code>Width</code>, <code>Thickness</code>, and <code>Weight</code> variables. (Hint: use <code>DartPoints$&lt;VARIABLE&gt;</code> as in <code>DartPoints$Length</code>.)</li>
<li>Use <code>var()</code> and <code>sd()</code> on the same.</li>
<li>Now use <code>skim()</code> to summarize the <code>DartPoints</code> data.</li>
</ul></li>
<li><strong>Graphics.</strong> And now to visualize them.
<ul>
<li>Use <code>ggplot()</code> to make a scatterplot showing dart point length as a function of weight. (Hint: use <code>geom_point()</code>.)</li>
<li>Is there a trend?</li>
<li>Map the dart point <code>Name</code> (this is the dart point type) to the <code>color</code> aesthetic. (Hint: this should go inside the <code>aes()</code> mapping!)</li>
<li>Do you see any meaningful differences between dart point types?</li>
<li>Change the <code>size</code> of all points to 2.5. (Hint: this should go outside the <code>aes()</code> mapping but inside <code>geom_point()</code>!)</li>
<li>Use <code>scale_color_viridis()</code> to make the color scale colorblind safe. Feel free to use whichever palette you prefer. (Hint: dart point type is a categorical variable, so you need to set <code>discrete = TRUE</code>!)</li>
<li>Try out <code>facet_wrap()</code> on the dart point <code>Name</code> variable.</li>
<li>Does this make it easier or harder to see differences between types?</li>
</ul></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
